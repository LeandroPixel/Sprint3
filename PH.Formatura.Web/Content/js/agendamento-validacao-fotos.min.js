var oPage={jqThis:null,oPhotos:null,oSwiper:null,IntervaloMouseHoldThumbImg:null,evento_click:"click",evento_mousedown:"mousedown",evento_mouseup:"mouseup",evento_contextmenu:"contextmenu",evento_touchend:"touchend",evento_wheel:"wheel",evento_keydown:"keydown",seletor_geral:"body",seletor_foto_selecionar:".cont-foto li:not(.grid-sizer)",seletor_foto_selecionar_img:".cont-foto li img",seletor_foto_filtro:".resumo-fotos a",seletor_btn_eu_quero:".btn-eu-quero",seletor_btn_view_thumb:"#btn-view-thumb",seletor_btn_view_big:"#btn-view-big",seletor_btn_view_flip:"#btn-view-flip",seletor_btn_change_view:".dvImageView a",seletor_foto_selecionar_view_big:".swiper-wrapper .swiper-slide .cont-img",seletor_foto_selecionar_view_big_img:".swiper-wrapper .swiper-slide .cont-img img",seletor_resumo:".resumo-fotos",seletor_btn_fechar:".btnFechar",seletor_thumbs:".thumbs",seletor_hold_preview:".hold-preview",seletor_bg_hold_preview:".bg-hold-preview",seletor_div_fechar_hold_preview:".div-fechar-hold-preview",seletor_view_thumb_foto:"#view-thumb-foto",seletor_swiper_container:".swiper-container",seletor_btn_carrousel_next:".btn-carrousel-next",seletor_btn_carrousel_prev:".btn-carrousel-prev",seletor_all_img:"img",string_active:"active",filtro:"todas",limit_percent_discart:0,percent_atual:0,viewType:"thumb",urlRender:"",token:"",delayFotos:800,_fotos_excluidas_qtd:0,_fotos_selecionadas_qtd:0,url_api_select_photo:(oGeral.string_url_base_aplicacao||oInicial.BaseUrlAplicacao)+"/api/Agendamento/SelectPhoto",albumIDCript:"",url_api_go_to_cart:(oGeral.string_url_base_aplicacao||oInicial.BaseUrlAplicacao)+"/api/Agendamento/GoToCart",alunoTurmaID:0,productID:0,qtdMinFoto:0,qtdMaxFoto:0,urlRetorno:"",isFirstAcess:!1,Carregar:function(n,t,i,r,u,f,e,o,s,h,c){var l=oPage;l.jqThis=$(l.seletor_geral);l.oPhotos=n;l.urlRender=t;l.token=i;l.albumIDCript=r;l.alunoTurmaID=u;l.productID=f;l.limit_percent_discart=e;l.qtdMinFoto=parseInt(o);l.qtdMaxFoto=parseInt(s);l.urlRetorno=h;l.isFirstAcess=c;l.jqThis.length&&l.CarregarEventos();l.CalculaResumo(l.oPhotos);oTurn.mIniciar()},CarregarEventos:function(){var n=oPage;$(n.seletor_foto_filtro).on(n.evento_click,function(){return n.ShowFotos(this),n.TratarCliqueAncorasResumoFotos(this),!1});$(n.seletor_btn_eu_quero).on(n.evento_click,function(t){return n.EuQuero(t,this),!1});$(n.seletor_btn_change_view).on(n.evento_click,function(t){return n.ChangeView(t,$(this).attr("data-view-type").toLowerCase()),!1});$(n.seletor_btn_fechar).on(n.evento_click,function(t){return n.ChangeView(t,"thumb"),!1});$(n.seletor_view_thumb_foto).isotope({itemSelector:"li",percentPosition:!0});$(n.seletor_foto_selecionar).on(n.evento_click,function(t){return n.SelecionarFoto(t,this),!1});$(n.seletor_all_img).on(n.evento_contextmenu,function(t){n.TratarOnContextMenu(t)});$(n.seletor_thumbs).on(n.evento_touchend,function(t){n.TratarTouchEndThumbs(t)});$(n.seletor_thumbs).longTouch(function(t,i){n.TratarLongTouch(t,i)},125);$(n.seletor_swiper_container).on(n.evento_wheel,function(t){n.TratarRolada(t)});$(document).on(n.evento_keydown,function(t){n.TratarKeyDown(t)})},TratarKeyDown:function(n){var t=oPage;$(t.seletor_swiper_container).is(":visible")&&(n.keyCode==37||n.keyCode==39)&&$(n.keyCode==37?t.seletor_btn_carrousel_prev:t.seletor_btn_carrousel_next).trigger(t.evento_click)},TratarOnContextMenu:function(n){return n.preventDefault(),!1},TratarRolada:function(n){var t=oPage;$(n.originalEvent.wheelDelta/120>0?t.seletor_btn_carrousel_prev:t.seletor_btn_carrousel_next).trigger(t.evento_click)},TratarTouchEndThumbs:function(){var n=oPage;$(n.seletor_hold_preview).promise().done(function(){$(n.seletor_div_fechar_hold_preview).click()})},TratarCliqueAncorasResumoFotos:function(n){var t=oPage;oPage.RefatoraIsotope();$("."+t.string_active+"[filtro]").not(n).removeClass(t.string_active);$(n).addClass(t.string_active)},TratarLongTouch:function(n,t){var i=oPage,s,h,o,f,e,r,u,c,l;$(i.seletor_hold_preview).remove();$(i.seletor_bg_hold_preview).remove();s=$(t.target).clone();s.on(i.evento_contextmenu,function(n){return i.TratarOnContextMenu(n)});return h=$('<div class="bg-hold-preview"><\/div>'),o=$('<div class="hold-preview"><\/div>'),$("body").append(o),$(o).append(s),$(o).css({position:"fixed",width:t.target.width+"px",height:t.target.height+"px",left:t.target.x+"px",top:t.target.y-Number($(t.target).css("margin-top").replace("px",""))+(t.target.width>t.target.height?Number($(t.target).css("margin-top").replace("px","")):0)+"px","z-index":11,"border-width":0,"border-color":"#fff","border-style":"solid",opacity:$(t.target).closest("li").css("opacity"),"-moz-opacity":$(t.target).closest("li").css("-moz-opacity"),filter:$(t.target).closest("li").css("filter")}),f=40,n[0].innerWidth>t.target.height?(e=t.target.width/t.target.height,u=Number((n[0].innerWidth-f*2).toFixed(2)),r=Number((u/e).toFixed(2)),n[0].innerHeight-r<f&&(r=Number((n[0].innerHeight-f*2).toFixed(2)),u=Number((r*e).toFixed(2)))):(e=t.target.height/t.target.width,r=Number((n[0].innerHeight-f*2).toFixed(2)),u=Number((r*e).toFixed(2)),n[0].innerWidth-u<f&&(u=Number((n[0].innerWidth-f*2).toFixed(2)),r=Number((u/e).toFixed(2)))),c=Number(n[0].innerHeight-r)/2,l=Number(n[0].innerWidth-u)/2,$(o).animate({width:u+"px",height:r+"px",left:l+"px",top:c+"px",borderWidth:"10px",opacity:1,"-moz-opacity":1,filter:"alpha(opacity=100)"},150,function(){$(this).append('<div class="div-fechar-hold-preview"><div class="glyphicon glyphicon-remove-sign"><\/div><\/div>');$("body").append(h);var n={width:t.target.width+"px",height:t.target.height+"px",left:t.target.x+"px",top:t.target.y-Number($(t.target).css("margin-top").replace("px",""))+(t.target.width>t.target.height?Number($(t.target).css("margin-top").replace("px","")):0)+"px",borderWidth:0};$(i.seletor_div_fechar_hold_preview).on(i.evento_click,function(t){t.preventDefault();i.TratarCliqueDivFecharHoldPreview(n)});$(i.seletor_bg_hold_preview).unbind().on(i.evento_click,function(n){n.preventDefault();$(i.seletor_div_fechar_hold_preview).trigger(i.evento_click)})}),!1},TratarCliqueDivFecharHoldPreview:function(n){var t=oPage;$(t.seletor_div_fechar_hold_preview).remove();$(t.seletor_bg_hold_preview).remove();$(t.seletor_hold_preview).animate(n,150,function(){$(this).fadeOut(function(){$(this).remove()})})},CalculaResumo:function(n){for(var f,o,t=oPage,e=n.length,r=0,i=0,u=0;u<e;u++)f=n[u],f.Selected,f.Selected?r++:i++;var s=$("#fotos_selecionadas"),h=$("#fotos_excluidas"),c=$("#fotos_excluidas_percent");s.html(r);h.html(i);t._fotos_excluidas_qtd=i;t._fotos_selecionadas_qtd=r;o=t.CalculaPercent(i,e);t.percent_atual=o;c.html(t.percent_atual+"%")},GetoPhotosById:function(n){for(var i,r=oPage,u=null,t=0;t<r.oPhotos.length;t++)if(i=r.oPhotos[t],n==i.PhotoIDCript){u=i;break}return u},GetoPhotosByFilter:function(n){for(var t,u=oPage,i=[],r=0;r<u.oPhotos.length;r++){t=u.oPhotos[r];switch(n.toLowerCase()){case"todas":i.push(t);break;case"selecionadas":t.Selected&&i.push(t);break;case"excluidas":t.Selected||i.push(t)}}return i},ShowFotos:function(n){var u=oPage,t=n!=undefined?$(n):$(u.seletor_foto_filtro+'[filtro="todas"]'),f=t.length>0?t.attr("filtro"):"todas",r,i;u.filtro=f;r=u.oPhotos;$(u.seletor_resumo).children().removeClass("active");t.addClass("active");switch(f){case"todas":for(i=0;i<r.length;i++)t=r[i],$("#"+t.PhotoIDCript).show();break;case"selecionadas":for(i=0;i<r.length;i++)t=r[i],t.Selected?$("#"+t.PhotoIDCript).show():$("#"+t.PhotoIDCript).hide();break;case"excluidas":for(i=0;i<r.length;i++)t=r[i],t.Selected==!1?$("#"+t.PhotoIDCript).show():$("#"+t.PhotoIDCript).hide()}u.ReloadSwiper()},ChangeView:function(n,t){var i=oPage;$(i.seletor_btn_change_view).removeClass("active");t=="thumb"?($(i.seletor_btn_view_thumb).addClass("active"),$(i.seletor_swiper_container).hide(),$(oTurn.sContainerTurn).hide(),$("#section-principal").removeClass("swiper-ativo")):t=="big"?($(i.seletor_btn_view_big).addClass("active"),$(i.seletor_swiper_container).css("opacity",1).show(),$(oTurn.sContainerTurn).hide(),$("#section-principal").addClass("swiper-ativo"),i.ReloadSwiper()):t=="flip"&&($(i.seletor_btn_view_flip).addClass("active"),$("#section-principal").addClass("swiper-ativo"),$(oTurn.sContainerTurn).show(),oTurn.mReconfigurarTurn());i.AjustarMargemImgSwiper();i.viewType=t.toLowerCase()},AjustarMargemImgSwiper:function(){var n=oPage;$(n.seletor_foto_selecionar_view_big_img).each(function(){$(this).css("margin-top",(window.innerHeight-this.height)/2+"px")})},CriaSwiper:function(n){for(var f,t=oPage,e=$(t.seletor_swiper_container).find(".swiper-wrapper"),o=t.GetoPhotosByFilter(n),r=0;r<o.length;r++){var u="",i=o[r],s=e.find("#sw_"+i.PhotoIDCript);s.length==0?(u='<div class="swiper-slide" id="sw_'+i.PhotoIDCript+'"><div class="cont-img" photoid="'+i.PhotoIDCript+'"><img alt="'+i.Nome+'" title="'+i.Nome+'" src="'+t.urlRender+"/?hash="+i.RenderMain+"&t="+t.token+'" class="'+(i.Height>i.Width?"portrait":"landscape")+" "+(i.Selected?"selecionado":"nao-selecionado")+'" /> <div class="checks"><div class="check-img '+(i.Selected?"selecionado":"nao-selecionado")+'"><\/div> <div class="no-check-img '+(i.Selected?"nao-selecionado":"selecionado")+'"><\/div> <\/div><\/div><\/div>',t.oSwiper==null?e.append(u):t.oSwiper.appendSlide(u)):(f=s.find("img"),i.Selected?f.removeClass("nao-selecionado").addClass("selecionado").parent().addClass("selecionado"):f.removeClass("selecionado").addClass("nao-selecionado").parent().removeClass("selecionado"))}t.jqThis.find(t.seletor_swiper_container+" "+t.seletor_all_img).on(t.evento_contextmenu,function(n){t.TratarOnContextMenu(n)});if(t.oSwiper==null){t.oSwiper=new Swiper(t.seletor_swiper_container,{nextButton:t.seletor_btn_carrousel_next,prevButton:t.seletor_btn_carrousel_prev,spaceBetween:30});t.jqThis.on(t.evento_click,t.seletor_foto_selecionar_view_big,function(n){return t.SelecionarFotoSwiper(n,this),!1})}},ReloadSwiper:function(){var n=oPage;n.DestroySwiper();n.CriaSwiper(n.filtro)},DestroySwiper:function(){var n=oPage;n.oSwiper!=null&&n.oSwiper.removeAllSlides()},DoSelecionarFoto:function(n){var t=oPage,f=$("#div-limite-fotos-modal");f.modal("hide");var e=$("#"+n),i=e.attr("id"),u=t.GetoPhotosById(i),o=$("#sw_"+i),r=o.find("img"),s={AlbumIDCript:t.albumIDCript,AlunoTurmaID:t.alunoTurmaID,ProductID:t.productID,QtdMinFoto:t.qtdMinFoto,QtdMaxFoto:t.qtdMaxFoto,isFirstAcess:t.isFirstAcess,fotos:[{PhotoIDCript:i,Selected:!u.Selected}]};t.RecalculaResumo(!u.Selected,!0);oUtil.ShowLoader(!0);$.ajax({url:t.url_api_select_photo,data:JSON.stringify(s),contentType:"application/json",method:"POST",headers:oUtil.GetToken()}).fail(function(n){oUtil.ShowModalError("","",n)}).done(function(n){var t=oPage,e,u,o,s,h,c,f;if(n.Sucesso==!1){oUtil.ShowModalError("",n.Mensagem);return}for(e=0;e<n.Obj.fotos.length;e++)u=n.Obj.fotos[e],f=$(document.getElementById(u.PhotoIDCript)),o=oPage.jqThis.find("#sw_"+u.PhotoIDCript).find("img"),r=oPage.jqThis.find("#sw_"+u.PhotoIDCript).find(".check-img"),elementoImg2=oPage.jqThis.find("#sw_"+u.PhotoIDCript).find(".no-check-img"),s=oPage.GetoPhotosById(u.PhotoIDCript),h=f.find("img"),t.filtro!="selecionadas"||u.Selected?t.filtro=="excluidas"&&u.Selected&&(f.hide(t.delayFotos),t._fotos_excluidas_qtd==0&&setTimeout(oPage.ShowFotos,800)):f.hide(t.delayFotos),u.Selected?(h.removeClass("nao-selecionado").addClass("selecionado").closest("li").removeClass("nao-selecionado").addClass("selecionado"),r.removeClass("nao-selecionado").addClass("selecionado").closest("li").removeClass("nao-selecionado").addClass("selecionado"),o.removeClass("nao-selecionado").addClass("selecionado"),elementoImg2.removeClass("selecionado").addClass("nao-selecionado"),s.Selected=!0):(h.removeClass("selecionado").addClass("nao-selecionado").closest("li").removeClass("selecionado").addClass("nao-selecionado"),r.removeClass("selecionado").addClass("nao-selecionado").closest("li").removeClass("selecionado").addClass("nao-selecionado"),o.removeClass("selecionado").addClass("nao-selecionado"),elementoImg2.removeClass("nao-selecionado").addClass("selecionado"),s.Selected=!1),t.oSwiper!=null&&t.filtro!="todas"&&(c=t.oSwiper.activeIndex,f=$("#sw_"+i),(t.filtro=="selecionadas"||t.filtro=="excluidas")&&(f.hide(t.delayFotos),setTimeout("oPage.oSwiper.removeSlide("+c+")",t.delayFotos)));t.oSwiper!=null&&t.filtro!="todas"&&setTimeout(oPage.RefatoraIsotope,t.delayFotos+1)}).always(function(){oUtil.ShowLoader(!1)})},RefatoraIsotope:function(){$(oPage.seletor_view_thumb_foto).isotope()},SelecionarFoto:function(n,t){var i=oPage,o=$(t),f=o.attr("id"),u=i.GetoPhotosById(f),e,r;if(u.Selected==!0&&parseInt(i.qtdMinFoto)>0&&i._fotos_selecionadas_qtd-1<parseInt(i.qtdMinFoto)&&(r=$("#div-min-fotos-modal"),r.modal()),u.Selected==!1&&parseInt(i.qtdMaxFoto)>0&&i._fotos_selecionadas_qtd+1>parseInt(i.qtdMaxFoto)&&(r=$("#div-max-fotos-modal"),r.modal()),e=i.RecalculaResumo(!u.Selected,!1),!e&&u.Selected==!0){r=$("#div-limite-fotos-modal");r.find(".btn-ok").unbind(i.evento_click);r.find(".btn-ok").on(i.evento_click,function(){return oPage.DoSelecionarFoto(f),!1});r.modal();return}i.DoSelecionarFoto(f)},SelecionarFotoSwiper:function(n,t){var i=oPage,r=t.getAttribute("photoid"),u=i.SelecionarFoto(n,document.getElementById(r))},CalculaPercent:function(n,t){return Math.round(n/t*100)},RecalculaResumo:function(n,t){var i=oPage,o=$("#fotos_selecionadas"),s=$("#fotos_excluidas"),h=$("#fotos_excluidas_percent"),c=parseInt($("#fotos_all").html()),r=parseInt(s.html()),u=parseInt(o.html()),f,e;return n!=undefined&&(n?(r-=1,u+=1):(r+=1,u-=1)),f=i.CalculaPercent(r,c),e=!1,e=f/100>i.limit_percent_discart&&i.limit_percent_discart>0?!1:!0,t&&(i.percent_atual=f,s.html(r),o.html(u),h.html(i.percent_atual+"%"),i._fotos_excluidas_qtd=r,i._fotos_selecionadas_qtd=u),e},EuQuero:function(){var n=oPage,t,r,u,i,f,e;if(n.qtdMinFoto>0&&n._fotos_selecionadas_qtd<n.qtdMinFoto)return t=$("#div-min-fotos-modal"),t.modal(),!1;if(n.qtdMaxFoto>0&&n._fotos_selecionadas_qtd>n.qtdMaxFoto){t=$("#div-max-fotos-modal");t.modal();return}for(r=n.oPhotos,u=[],i=0;i<r.length;i++)f=r[i],u.push({PhotoIDCript:f.PhotoIDCript,Selected:f.Selected});oUtil.ShowLoader(!0);e={AlbumIDCript:n.albumIDCript,AlunoTurmaID:n.alunoTurmaID,ProductID:n.productID,QtdMinFoto:n.qtdMinFoto,QtdMaxFoto:n.qtdMaxFoto,isFirstAcess:n.isFirstAcess,fotos:u};$.ajax({url:n.url_api_go_to_cart,data:JSON.stringify(e),contentType:"application/json",method:"POST",headers:oUtil.GetToken()}).fail(function(n){oUtil.ShowModalError("","",n)}).done(function(n){var i=oPage,t;if(n.Sucesso==!1){n.Mensagem.toLowerCase()=="limit_min"?(t=$("#div-min-fotos-modal"),t.modal()):n.Mensagem.toLowerCase()=="limit_max"?(t=$("#div-max-fotos-modal"),t.modal()):oUtil.ShowModalError("",n.Mensagem);return}document.location.href=urlRetorno}).always(function(){oUtil.ShowLoader(!1)})}},oTurn={vImagens:[],oThis:null,oControleCliquePagina:0,eClick:"click",eTurned:"turned",sContainerTurn:".container-turn",sTurn:".turn",sPageWrapper:".page-wrapper",sBtnTurnNav:".btn-turn-nav",mIniciar:function(){var n=oTurn;n.oThis=$(n.sTurn);n.oThis.length&&(n.mCriarImagens(),n.mConfigurarTurn());window.screen.orientation.onchange=function(){oTurn.mReconfigurarTurn()};window.addEventListener("resize",function(){oTurn.mReconfigurarTurn()})},mCriarImagens:function(){var n=oTurn,r=oPage.oPhotos,u='<div class="page" {$style}><\/div>',t,i;if(r){for(t=0;t<r.length;t++)i=r[t],n.vImagens.push({name:i.Nome,orientation:i.Height>i.Width?"portrait":"landscape",selected:i.Selected?"selecionado":"nao-selecionado",src:oPage.urlRender+"/?hash="+i.RenderMain+"&t="+oPage.token,photoId:i.PhotoIDCript}),t==0?n.oThis.append('<div class="page" style="background-image: url(\'{$src}\');"><\/div>'.replace("{$src}",n.vImagens[t].src)):t==r.length-1?n.oThis.append(u.replace("{$style}",n.vImagens[t].bg?"style=\"background-image: url('"+n.vImagens[t].src+"');\"":"")):n.oThis.append('<div class="page" style="background-image: url(\'{$src}\');"><\/div>'.replace("{$src}",n.vImagens[t].src));r.length%2!=0&&n.oThis.append(u.replace("{$style}",""));n.mConfigurarListners()}},mConfigurarTurn:function(){var t=oTurn,u=0,n=1.5,i,r,f;window.innerWidth/n<=window.innerHeight-u?(i=(window.innerHeight-u)*n,r=i/n):(r=(window.innerWidth-u)/n,i=r*n);t.oThis.css({marginTop:f,acceleration:!0,gradients:!0});t.oThis.turn({width:i,height:r});f=(window.innerHeight-t.oThis.height())/2;t.oThis.css({marginTop:f})},mReconfigurarTurn:function(){var n=oTurn;n.oThis.turn("is")&&n.oThis.turn("destroy");n.mCriarImagens();n.mConfigurarTurn();n.mAdicionarClassesPageWrapper()},mAdicionarClassesPageWrapper:function(){var n=oTurn;$(n.sPageWrapper).removeClass("page-wrapper-par page-wrapper-impar").addClass(function(){return Number($(this).attr("page"))%2==0?"page-wrapper-par":"page-wrapper-impar"})},mConfigurarListners:function(){var n=oTurn;n.oThis.unbind(n.eTurned).on(n.eTurned,function(){n.mAdicionarClassesPageWrapper()});$(n.sBtnTurnNav).unbind(n.eClick).on(n.eClick,function(t){return t.preventDefault(),n.mTratarCliqueSetasNavegacao(this),!1})},mTratarCliqueSetasNavegacao:function(n){var t=oTurn;$(n).hasClass("next")?t.oThis.turn("next"):$(n).hasClass("previous")&&t.oThis.turn("previous")}};$(document).ready(function(){oPage.Carregar(oPhotos,urlRender,token,albumIDCript,alunoTurmaID,productID,limit_percent_discart,qtdMinFoto,qtdMaxFoto,urlRetorno,isFirstAcess);oUtil.ShowLoader(!0)});$(window).load(function(){oUtil.ShowLoader(!1);oPage.RefatoraIsotope()});window.screen.orientation.onchange=function(){oPage.AjustarMargemImgSwiper()};window.addEventListener("resize",function(){oPage.AjustarMargemImgSwiper()});
/*
//# sourceMappingURL=agendamento-validacao-fotos.min.js.map
*/