(function(n){function d(n,t,i){if(!i[0]||"object"==typeof i[0])return t.init.apply(n,i);if(t[i[0]])return t[i[0]].apply(n,Array.prototype.slice.call(i,1));throw e(i[0]+" is not a method or property");}function f(n,t,i,r){return{css:{position:"absolute",top:n,left:t,overflow:r||"hidden",zIndex:i||"auto"}}}function g(n,t,i,u,f){var e=1-f,o=e*e*e,s=f*f*f;return r(Math.round(o*n.x+3*f*e*e*t.x+3*f*f*e*i.x+s*u.x),Math.round(o*n.y+3*f*e*e*t.y+3*f*f*e*i.y+s*u.y))}function r(n,t){return{x:n,y:t}}function c(n,t,i){return k&&i?" translate3d("+n+"px,"+t+"px, 0px) ":" translate("+n+"px, "+t+"px) "}function l(n){return" rotate("+n+"deg) "}function u(n,t){return Object.prototype.hasOwnProperty.call(t,n)}function nt(){for(var n=["Moz","Webkit","Khtml","O","ms"],t=n.length,i="";t--;)n[t]+"Transform"in document.body.style&&(i="-"+n[t].toLowerCase()+"-");return i}function w(n,t,i,u,f){var e,h=[];if("-webkit-"==o){for(e=0;e<f;e++)h.push("color-stop("+u[e][0]+", "+u[e][1]+")");n.css({"background-image":"-webkit-gradient(linear, "+t.x+"% "+t.y+"%,"+i.x+"% "+i.y+"%, "+h.join(",")+" )"})}else{var t={x:t.x/100*n.width(),y:t.y/100*n.height()},i={x:i.x/100*n.width(),y:i.y/100*n.height()},c=i.x-t.x;e=i.y-t.y;var l=Math.atan2(e,c),a=l-Math.PI/2,a=Math.abs(n.width()*Math.sin(a))+Math.abs(n.height()*Math.cos(a)),c=Math.sqrt(e*e+c*c),i=r(i.x<t.x?n.width():0,i.y<t.y?n.height():0),s=Math.tan(l);for(e=-1/s,s=(e*i.x-i.y-s*t.x+t.y)/(e-s),i=e*s-e*i.x+i.y,t=Math.sqrt(Math.pow(s-t.x,2)+Math.pow(i-t.y,2)),e=0;e<f;e++)h.push(" "+u[e][1]+" "+100*(t+c*u[e][0])/a+"%");n.css({"background-image":o+"linear-gradient("+-l+"rad,"+h.join(",")+")"})}}function a(t,i,r){return t=n.Event(t),i.trigger(t,r),t.isDefaultPrevented()?"prevented":t.isPropagationStopped()?"stopped":""}function e(n){function t(n){this.name="TurnJsError";this.message=n}return t.prototype=Error(),t.prototype.constructor=t,new t(n)}function b(n){var t={top:0,left:0};do t.left+=n.offsetLeft,t.top+=n.offsetTop;while(n=n.offsetParent);return t}var k,tt,o="",y=Math.PI,p=y/2,v="ontouchstart"in window,h=v?{down:"touchstart",move:"touchmove",up:"touchend",over:"touchstart",out:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup",over:"mouseover",out:"mouseout"},s={backward:["bl","tl"],forward:["br","tr"],all:"tl bl tr br l r".split(" ")},it=["single","double"],rt=["ltr","rtl"],ut={acceleration:!0,display:"double",duration:600,page:1,gradients:!0,turnCorners:"bl,br",when:null},ft={cornerSize:100},t={init:function(i){var e,f;k="WebKitCSSMatrix"in window||"MozPerspective"in document.body.style;tt=(e=/AppleWebkit\/([0-9\.]+)/i.exec(navigator.userAgent))?534.3<parseFloat(e[1]):!0;o=nt();e=0;var r=this.data(),s=this.children(),i=n.extend({width:this.width(),height:this.height(),direction:this.attr("dir")||this.css("direction")||"ltr"},ut,i);if(r.opts=i,r.pageObjs={},r.pages={},r.pageWrap={},r.pageZoom={},r.pagePlace={},r.pageMv=[],r.zoom=1,r.totalPages=i.pages||0,r.eventHandlers={touchStart:n.proxy(t._touchStart,this),touchMove:n.proxy(t._touchMove,this),touchEnd:n.proxy(t._touchEnd,this),start:n.proxy(t._eventStart,this)},i.when)for(f in i.when)u(f,i.when)&&this.bind(f,i.when[f]);for(this.css({position:"relative",width:i.width,height:i.height}),this.turn("display",i.display),""!==i.direction&&this.turn("direction",i.direction),k&&!v&&i.acceleration&&this.transform(c(0,0,!0)),f=0;f<s.length;f++)"1"!=n(s[f]).attr("ignore")&&this.turn("addPage",s[f],++e);return n(this).bind(h.down,r.eventHandlers.touchStart).bind("end",t._eventEnd).bind("pressed",t._eventPressed).bind("released",t._eventReleased).bind("flip",t._flip),n(this).parent().bind("start",r.eventHandlers.start),n(document).bind(h.move,r.eventHandlers.touchMove).bind(h.up,r.eventHandlers.touchEnd),this.turn("page",i.page),r.done=!0,this},addPage:function(i,r){var o,s=!1,u=this.data(),f=u.totalPages+1;if(u.destroying)return!1;if((o=/\bp([0-9]+)\b/.exec(n(i).attr("class")))&&(r=parseInt(o[1],10)),r){if(r==f)s=!0;else if(r>f)throw e('Page "'+r+'" cannot be inserted');}else r=f,s=!0;return 1<=r&&r<=f&&(o="double"==u.display?r%2?" odd":" even":"",u.done&&this.turn("stop"),r in u.pageObjs&&t._movePages.call(this,r,1),s&&(u.totalPages=f),u.pageObjs[r]=n(i).css({float:"left"}).addClass("page p"+r+o),-1!=navigator.userAgent.indexOf("MSIE 9.0")&&u.pageObjs[r].hasClass("hard")&&u.pageObjs[r].removeClass("hard"),t._addPage.call(this,r),t._removeFromDOM.call(this)),this},_addPage:function(i){var r=this.data(),f=r.pageObjs[i],u;f&&(t._necessPage.call(this,i)?(r.pageWrap[i]||(r.pageWrap[i]=n("<div/>",{"class":"page-wrapper",page:i,css:{position:"absolute",overflow:"hidden"}}),this.append(r.pageWrap[i]),r.pagePlace[i]||(r.pagePlace[i]=i,r.pageObjs[i].appendTo(r.pageWrap[i])),u=t._pageSize.call(this,i,!0),f.css({width:u.width,height:u.height}),r.pageWrap[i].css(u)),r.pagePlace[i]==i&&t._makeFlip.call(this,i)):(r.pagePlace[i]=0,r.pageObjs[i]&&r.pageObjs[i].remove()))},hasPage:function(n){return u(n,this.data().pageObjs)},center:function(t){var i=this.data(),u=n(this).turn("size"),r=0;return i.noCenter||("double"==i.display&&(t=this.turn("view",t||i.tpage||i.page),"ltr"==i.direction?t[0]?t[1]||(r+=u.width/4):r-=u.width/4:t[0]?t[1]||(r-=u.width/4):r+=u.width/4),n(this).css({marginLeft:r})),this},destroy:function(){var i=this,t=this.data(),r="end first flip last pressed released start turning turned zooming missing".split(" ");if("prevented"!=a("destroying",this)){for(t.destroying=!0,n.each(r,function(n,t){i.unbind(t)}),this.parent().unbind("start",t.eventHandlers.start),n(document).unbind(h.move,t.eventHandlers.touchMove).unbind(h.up,t.eventHandlers.touchEnd);0!==t.totalPages;)this.turn("removePage",t.totalPages);return t.fparent&&t.fparent.remove(),t.shadow&&t.shadow.remove(),this.removeData(),t=null,this}},is:function(){return"object"==typeof this.data().pages},zoom:function(i){var r=this.data();if("number"==typeof i){if(.001>i||100<i)throw e(i+" is not a value for zoom");if("prevented"==a("zooming",this,[i,r.zoom]))return this;var f=this.turn("size"),u=this.turn("view"),o=1/r.zoom,s=Math.round(f.width*o*i),f=Math.round(f.height*o*i);for(r.zoom=i,n(this).turn("stop").turn("size",s,f),r.opts.autoCenter&&this.turn("center"),t._updateShadow.call(this),i=0;i<u.length;i++)u[i]&&r.pageZoom[u[i]]!=r.zoom&&(this.trigger("zoomed",[u[i],u,r.pageZoom[u[i]],r.zoom]),r.pageZoom[u[i]]=r.zoom);return this}return r.zoom},_pageSize:function(n,t){var r=this.data(),i={},f,e,u;return"single"==r.display?(i.width=this.width(),i.height=this.height(),t&&(i.top=0,i.left=0,i.right="auto")):(f=this.width()/2,e=this.height(),r.pageObjs[n].hasClass("own-size")?(i.width=r.pageObjs[n].width(),i.height=r.pageObjs[n].height()):(i.width=f,i.height=e),t&&(u=n%2,i.top=(e-i.height)/2,"ltr"==r.direction?(i[u?"right":"left"]=f-i.width,i[u?"left":"right"]="auto"):(i[u?"left":"right"]=f-i.width,i[u?"right":"left"]="auto"))),i},_makeFlip:function(n){var i=this.data(),r,u;return i.pages[n]||i.pagePlace[n]!=n||(r="single"==i.display,u=n%2,i.pages[n]=i.pageObjs[n].css(t._pageSize.call(this,n)).flip({page:n,next:u||r?n+1:n-1,turn:this}).flip("disable",i.disabled),t._setPageLoc.call(this,n),i.pageZoom[n]=i.zoom),i.pages[n]},_makeRange:function(){var n,i;if(!(1>this.data().totalPages))for(i=this.turn("range"),n=i[0];n<=i[1];n++)t._addPage.call(this,n)},range:function(n){var u,f,i,r=this.data(),n=n||r.tpage||r.page||1;if(i=t._view.call(this,n),1>n||n>r.totalPages)throw e('"'+n+'" is not a valid page');return i[1]=i[1]||i[0],1<=i[0]&&i[1]<=r.totalPages?(n=Math.floor(2),r.totalPages-i[1]>i[0]?(u=Math.min(i[0]-1,n),f=2*n-u):(f=Math.min(r.totalPages-i[1],n),u=2*n-f)):f=u=5,[Math.max(1,i[0]-u),Math.min(r.totalPages,i[1]+f)]},_necessPage:function(n){if(0===n)return!0;var t=this.turn("range");return this.data().pageObjs[n].hasClass("fixed")||n>=t[0]&&n<=t[1]},_removeFromDOM:function(){var n,i=this.data();for(n in i.pageWrap)u(n,i.pageWrap)&&!t._necessPage.call(this,n)&&t._removePageFromDOM.call(this,n)},_removePageFromDOM:function(n){var r=this.data(),u;r.pages[n]&&(u=r.pages[n].data(),i._moveFoldingPage.call(r.pages[n],!1),u.f&&u.f.fwrapper&&u.f.fwrapper.remove(),r.pages[n].removeData(),r.pages[n].remove(),delete r.pages[n]);r.pageObjs[n]&&r.pageObjs[n].remove();r.pageWrap[n]&&(r.pageWrap[n].remove(),delete r.pageWrap[n]);t._removeMv.call(this,n);delete r.pagePlace[n];delete r.pageZoom[n]},removePage:function(n){var i=this.data();if("*"==n)for(;0!==i.totalPages;)this.turn("removePage",i.totalPages);else{if(1>n||n>i.totalPages)throw e("The page "+n+" doesn't exist");i.pageObjs[n]&&(this.turn("stop"),t._removePageFromDOM.call(this,n),delete i.pageObjs[n]);t._movePages.call(this,n,-1);i.totalPages-=1;i.page>i.totalPages?(i.page=null,t._fitPage.call(this,i.totalPages)):(t._makeRange.call(this),this.turn("update"))}return this},_movePages:function(n,i){var u,e=this,r=this.data(),o="single"==r.display,f=function(n){var u=n+i,f=u%2,s=f?" odd ":" even ";r.pageObjs[n]&&(r.pageObjs[u]=r.pageObjs[n].removeClass("p"+n+" odd even").addClass("p"+u+s));r.pagePlace[n]&&r.pageWrap[n]&&(r.pagePlace[u]=u,r.pageWrap[u]=r.pageObjs[u].hasClass("fixed")?r.pageWrap[n].attr("page",u):r.pageWrap[n].css(t._pageSize.call(e,u,!0)).attr("page",u),r.pages[n]&&(r.pages[u]=r.pages[n].flip("options",{page:u,next:o||f?u+1:u-1})),i&&(delete r.pages[n],delete r.pagePlace[n],delete r.pageZoom[n],delete r.pageObjs[n],delete r.pageWrap[n]))};if(0<i)for(u=r.totalPages;u>=n;u--)f(u);else for(u=n;u<=r.totalPages;u++)f(u)},display:function(i){var r=this.data(),u=r.display;if(void 0===i)return u;if(-1==n.inArray(i,it))throw e('"'+i+'" is not a value for display');switch(i){case"single":r.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),r.pageObjs[0]=n("<div />",{"class":"page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this));this.addClass("shadow");break;case"double":r.pageObjs[0]&&(this.turn("stop").css({overflow:""}),r.pageObjs[0].remove(),delete r.pageObjs[0]);this.removeClass("shadow")}return r.display=i,u&&(i=this.turn("size"),t._movePages.call(this,1,0),this.turn("size",i.width,i.height).turn("update")),this},direction:function(t){var i=this.data();if(void 0===t)return i.direction;if(t=t.toLowerCase(),-1==n.inArray(t,rt))throw e('"'+t+'" is not a value for direction');return"rtl"==t&&n(this).attr("dir","ltr").css({direction:"ltr"}),i.direction=t,i.done&&this.turn("size",n(this).width(),n(this).height()),this},animating:function(){return 0<this.data().pageMv.length},corner:function(){var i,n,t=this.data();for(n in t.pages)if(u(n,t.pages)&&(i=t.pages[n].flip("corner")))return i;return!1},data:function(){return this.data()},disable:function(t){var r,i=this.data(),f=this.turn("view");i.disabled=void 0===t||!0===t;for(r in i.pages)u(r,i.pages)&&i.pages[r].flip("disable",i.disabled?!0:-1==n.inArray(parseInt(r,10),f));return this},disabled:function(n){return void 0===n?!0===this.data().disabled:this.turn("disable",n)},size:function(n,i){if(void 0===n||void 0===i)return{width:this.width(),height:this.height()};this.turn("stop");var e,f,r=this.data();f="double"==r.display?n/2:n;this.css({width:n,height:i});r.pageObjs[0]&&r.pageObjs[0].css({width:f,height:i});for(e in r.pageWrap)u(e,r.pageWrap)&&(f=t._pageSize.call(this,e,!0),r.pageObjs[e].css({width:f.width,height:f.height}),r.pageWrap[e].css(f),r.pages[e]&&r.pages[e].css({width:f.width,height:f.height}));return this.turn("resize"),this},resize:function(){var i,n=this.data();for(n.pages[0]&&(n.pageWrap[0].css({left:-this.width()}),n.pages[0].flip("resize",!0)),i=1;i<=n.totalPages;i++)n.pages[i]&&n.pages[i].flip("resize",!0);t._updateShadow.call(this);n.opts.autoCenter&&this.turn("center")},_removeMv:function(n){for(var i=this.data(),t=0;t<i.pageMv.length;t++)if(i.pageMv[t]==n)return i.pageMv.splice(t,1),!0;return!1},_addMv:function(n){var i=this.data();t._removeMv.call(this,n);i.pageMv.push(n)},_view:function(n){var t=this.data(),n=n||t.page;return"double"==t.display?n%2?[n-1,n]:[n,n+1]:[n]},view:function(n){var i=this.data(),n=t._view.call(this,n);return"double"==i.display?[0<n[0]?n[0]:0,n[1]<=i.totalPages?n[1]:0]:[0<n[0]&&n[0]<=i.totalPages?n[0]:0]},stop:function(n,t){if(this.turn("animating")){var f,u,e,r=this.data();for(r.tpage&&(r.page=r.tpage,delete r.tpage),f=0;f<r.pageMv.length;f++)r.pageMv[f]&&r.pageMv[f]!==n&&(e=r.pages[r.pageMv[f]],u=e.data().f.opts,e.flip("hideFoldedPage",t),t||i._moveFoldingPage.call(e,!1),u.force&&(u.next=0==u.page%2?u.page-1:u.page+1,delete u.force))}return this.turn("update"),this},pages:function(n){var i=this.data(),r;if(n){if(n<i.totalPages)for(r=i.totalPages;r>n;r--)this.turn("removePage",r);return i.totalPages=n,t._fitPage.call(this,i.page),this}return i.totalPages},_missing:function(n){var i=this.data();if(!(1>i.totalPages)){for(var r=this.turn("range",n),t=[],n=r[0];n<=r[1];n++)i.pageObjs[n]||t.push(n);0<t.length&&this.trigger("missing",[t])}},_fitPage:function(n){var i=this.data(),r=this.turn("view",n),u;if(t._missing.call(this,n),i.pageObjs[n]){for(i.page=n,this.turn("stop"),u=0;u<r.length;u++)r[u]&&i.pageZoom[r[u]]!=i.zoom&&(this.trigger("zoomed",[r[u],r,i.pageZoom[r[u]],i.zoom]),i.pageZoom[r[u]]=i.zoom);t._removeFromDOM.call(this);t._makeRange.call(this);t._updateShadow.call(this);this.trigger("turned",[n,r]);this.turn("update");i.opts.autoCenter&&this.turn("center")}},_turnPage:function(i){var u,o,r=this.data(),s=r.pagePlace[i],f=this.turn("view"),e=this.turn("view",i),h;if(r.page!=i){if(h=r.page,"prevented"==a("turning",this,[i,e])){h==r.page&&-1!=n.inArray(s,r.pageMv)&&r.pages[s].flip("hideFoldedPage",!0);return}-1!=n.inArray(1,e)&&this.trigger("first");-1!=n.inArray(r.totalPages,e)&&this.trigger("last")}"single"==r.display?(u=f[0],o=e[0]):f[1]&&i>f[1]?(u=f[1],o=e[0]):f[0]&&i<f[0]&&(u=f[0],o=e[1]);s=r.opts.turnCorners.split(",");f=r.pages[u].data().f;e=f.opts;h=f.point;t._missing.call(this,i);r.pageObjs[i]&&(this.turn("stop"),r.page=i,t._makeRange.call(this),r.tpage=o,e.next!=o&&(e.next=o,e.force=!0),this.turn("update"),f.point=h,"hard"==f.effect?"ltr"==r.direction?r.pages[u].flip("turnPage",i>u?"r":"l"):r.pages[u].flip("turnPage",i>u?"l":"r"):"ltr"==r.direction?r.pages[u].flip("turnPage",s[i>u?1:0]):r.pages[u].flip("turnPage",s[i>u?0:1]))},page:function(i){var r=this.data();if(void 0===i)return r.page;if(!r.disabled&&!r.destroying){if(i=parseInt(i,10),0<i&&i<=r.totalPages)return i!=r.page&&(!r.done||-1!=n.inArray(i,this.turn("view"))?t._fitPage.call(this,i):t._turnPage.call(this,i)),this;throw e("The page "+i+" does not exist");}},next:function(){return this.turn("page",Math.min(this.data().totalPages,t._view.call(this,this.data().page).pop()+1))},previous:function(){return this.turn("page",Math.max(1,t._view.call(this,this.data().page).shift()-1))},peel:function(n,t){var r=this.data(),i=this.turn("view"),t=void 0===t?!0:!0===t;return!1===n?this.turn("stop",null,t):"single"==r.display?r.pages[r.page].flip("peel",n,t):(i="ltr"==r.direction?-1!=n.indexOf("l")?i[0]:i[1]:-1!=n.indexOf("l")?i[1]:i[0],r.pages[i]&&r.pages[i].flip("peel",n,t)),this},_addMotionPage:function(){var i=n(this).data().f.opts,r=i.turn;r.data();t._addMv.call(r,i.page)},_eventStart:function(n,i,r){var u=i.turn.data(),f=u.pageZoom[i.page];n.isDefaultPrevented()||(f&&f!=u.zoom&&(i.turn.trigger("zoomed",[i.page,i.turn.turn("view",i.page),f,u.zoom]),u.pageZoom[i.page]=u.zoom),"single"==u.display&&r&&("l"==r.charAt(1)&&"ltr"==u.direction||"r"==r.charAt(1)&&"rtl"==u.direction?(i.next=i.next<i.page?i.next:i.page-1,i.force=!0):i.next=i.next>i.page?i.next:i.page+1),t._addMotionPage.call(n.target));t._updateShadow.call(i.turn)},_eventEnd:function(i,r,u){n(i.target).data();var i=r.turn,f=i.data();u?(u=f.tpage||f.page,u==r.next||u==r.page)&&(delete f.tpage,t._fitPage.call(i,u||r.next,!0)):(t._removeMv.call(i,r.page),t._updateShadow.call(i),i.turn("update"))},_eventPressed:function(t){var t=n(t.target).data().f,i=t.opts.turn;return i.data().mouseAction=!0,i.turn("update"),t.time=(new Date).getTime()},_eventReleased:function(i,r){var u=n(i.target);var f=u.data().f,e=f.opts.turn,o=e.data();u="single"==o.display?"br"==r.corner||"tr"==r.corner?r.x<u.width()/2:r.x>u.width()/2:0>r.x||r.x>u.width();(200>(new Date).getTime()-f.time||u)&&(i.preventDefault(),t._turnPage.call(e,f.opts.next));o.mouseAction=!1},_flip:function(t){t.stopPropagation();t=n(t.target).data().f.opts;t.turn.trigger("turn",[t.next]);t.turn.data().opts.autoCenter&&t.turn.turn("center",t.next)},_touchStart:function(){var n=this.data();for(var t in n.pages)if(u(t,n.pages)&&!1===i._eventStart.apply(n.pages[t],arguments))return!1},_touchMove:function(){var n=this.data();for(var t in n.pages)u(t,n.pages)&&i._eventMove.apply(n.pages[t],arguments)},_touchEnd:function(){var n=this.data();for(var t in n.pages)u(t,n.pages)&&i._eventEnd.apply(n.pages[t],arguments)},calculateZ:function(n){var t,i,r,e,h=this,u=this.data();t=this.turn("view");var c=t[0]||t[1],o=n.length-1,f={pageZ:{},partZ:{},pageV:{}},s=function(n){n=h.turn("view",n);n[0]&&(f.pageV[n[0]]=!0);n[1]&&(f.pageV[n[1]]=!0)};for(t=0;t<=o;t++)i=n[t],r=u.pages[i].data().f.opts.next,e=u.pagePlace[i],s(i),s(r),i=u.pagePlace[r]==r?r:i,f.pageZ[i]=u.totalPages-Math.abs(c-i),f.partZ[e]=2*u.totalPages-o+t;return f},update:function(){var i,r=this.data();if(this.turn("animating")&&0!==r.pageMv[0]){var f,e=this.turn("calculateZ",r.pageMv),h=this.turn("corner"),o=this.turn("view"),s=this.turn("view",r.tpage);for(i in r.pageWrap)u(i,r.pageWrap)&&(f=r.pageObjs[i].hasClass("fixed"),r.pageWrap[i].css({display:e.pageV[i]||f?"":"none",zIndex:(r.pageObjs[i].hasClass("hard")?e.partZ[i]:e.pageZ[i])||(f?-1:0)}),f=r.pages[i])&&(f.flip("z",e.partZ[i]||null),e.pageV[i]&&f.flip("resize"),r.tpage?f.flip("hover",!1).flip("disable",-1==n.inArray(parseInt(i,10),r.pageMv)&&i!=s[0]&&i!=s[1]):f.flip("hover",!1===h).flip("disable",i!=o[0]&&i!=o[1]))}else for(i in r.pageWrap)u(i,r.pageWrap)&&(e=t._setPageLoc.call(this,i),r.pages[i]&&r.pages[i].flip("disable",r.disabled||1!=e).flip("hover",!0).flip("z",null));return this},_updateShadow:function(){var i,u,t=this.data(),e=this.width(),o=this.height(),s="single"==t.display?e:e/2,r;for(i=this.turn("view"),t.shadow||(t.shadow=n("<div />",{"class":"shadow",css:f(0,0,0).css}).appendTo(this)),r=0;r<t.pageMv.length&&i[0]&&i[1];r++)i=this.turn("view",t.pages[t.pageMv[r]].data().f.opts.next),u=this.turn("view",t.pageMv[r]),i[0]=i[0]&&u[0],i[1]=i[1]&&u[1];switch(i[0]?i[1]?3:"ltr"==t.direction?2:1:"ltr"==t.direction?1:2){case 1:t.shadow.css({width:s,height:o,top:0,left:s});break;case 2:t.shadow.css({width:s,height:o,top:0,left:0});break;case 3:t.shadow.css({width:e,height:o,top:0,left:0})}},_setPageLoc:function(n){var t=this.data(),i=this.turn("view"),r=0;if(n==i[0]||n==i[1]?r=1:("single"==t.display&&n==i[0]+1||"double"==t.display&&n==i[0]-2||n==i[1]+2)&&(r=2),!this.turn("animating"))switch(r){case 1:t.pageWrap[n].css({zIndex:t.totalPages,display:""});break;case 2:t.pageWrap[n].css({zIndex:t.totalPages-1,display:""});break;case 0:t.pageWrap[n].css({zIndex:0,display:t.pageObjs[n].hasClass("fixed")?"":"none"})}return r},options:function(t){var r,i;if(void 0===t)return this.data().opts;if(r=this.data(),n.extend(r.opts,t),t.pages&&this.turn("pages",t.pages),t.page&&this.turn("page",t.page),t.display&&this.turn("display",t.display),t.direction&&this.turn("direction",t.direction),t.width&&t.height&&this.turn("size",t.width,t.height),t.when)for(i in t.when)u(i,t.when)&&this.unbind(i).bind(i,t.when[i]);return this},version:function(){return"4.1.0"}},i={init:function(n){return this.data({f:{disabled:!1,hover:!1,effect:this.hasClass("hard")?"hard":"sheet"}}),this.flip("options",n),i._addPageWrapper.call(this),this},setData:function(t){var i=this.data();return i.f=n.extend(i.f,t),this},options:function(t){var r=this.data().f;return t?(i.setData.call(this,{opts:n.extend({},r.opts||ft,t)}),this):r.opts},z:function(n){var t=this.data().f;return t.opts["z-index"]=n,t.fwrapper&&t.fwrapper.css({zIndex:n||parseInt(t.parent.css("z-index"),10)||0}),this},_cAllowed:function(){var i=this.data().f,r=i.opts.page,n=i.opts.turn.data(),t=r%2;return"hard"==i.effect?"ltr"==n.direction?[t?"r":"l"]:[t?"l":"r"]:"single"==n.display?1==r?"ltr"==n.direction?s.forward:s.backward:r==n.totalPages?"ltr"==n.direction?s.backward:s.forward:s.all:"ltr"==n.direction?s[t?"forward":"backward"]:s[t?"backward":"forward"]},_cornerActivated:function(t){var f=this.data().f,u=this.width(),e=this.height(),t={x:t.x,y:t.y,corner:""},r=f.opts.cornerSize,o;if(0>=t.x||0>=t.y||t.x>=u||t.y>=e)return!1;o=i._cAllowed.call(this);switch(f.effect){case"hard":if(t.x>u-r)t.corner="r";else if(t.x<r)t.corner="l";else return!1;break;case"sheet":if(t.y<r)t.corner+="t";else if(t.y>=e-r)t.corner+="b";else return!1;if(t.x<=r)t.corner+="l";else if(t.x>=u-r)t.corner+="r";else return!1}return!t.corner||-1==n.inArray(t.corner,o)?!1:t},_isIArea:function(n){var t=this.data().f.parent.offset(),n=v&&n.originalEvent?n.originalEvent.touches[0]:n;return i._cornerActivated.call(this,{x:n.pageX-t.left,y:n.pageY-t.top})},_c:function(n,t){t=t||0;switch(n){case"tl":return r(t,t);case"tr":return r(this.width()-t,t);case"bl":return r(t,this.height()-t);case"br":return r(this.width()-t,this.height()-t);case"l":return r(t,0);case"r":return r(this.width()-t,0)}},_c2:function(n){switch(n){case"tl":return r(2*this.width(),0);case"tr":return r(-this.width(),0);case"bl":return r(2*this.width(),this.height());case"br":return r(-this.width(),this.height());case"l":return r(2*this.width(),0);case"r":return r(-this.width(),0)}},_foldingPage:function(){var n=this.data().f,t;if(n&&(t=n.opts,t.turn))return n=t.turn.data(),"single"==n.display?1<t.next||1<t.page?n.pageObjs[0]:null:n.pageObjs[t.next]},_backGradient:function(){var t=this.data().f,i=t.opts.turn.data();return(i=i.opts.gradients&&("single"==i.display||2!=t.opts.page&&t.opts.page!=i.totalPages-1))&&!t.bshadow&&(t.bshadow=n("<div/>",f(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(t.parent)),i},type:function(){return this.data().f.effect},resize:function(n){var t=this.data().f,f=t.opts.turn.data(),r=this.width(),u=this.height();switch(t.effect){case"hard":n&&(t.wrapper.css({width:r,height:u}),t.fpage.css({width:r,height:u}),f.opts.gradients&&(t.ashadow.css({width:r,height:u}),t.bshadow.css({width:r,height:u})));break;case"sheet":n&&(n=Math.round(Math.sqrt(Math.pow(r,2)+Math.pow(u,2))),t.wrapper.css({width:n,height:n}),t.fwrapper.css({width:n,height:n}).children(":first-child").css({width:r,height:u}),t.fpage.css({width:r,height:u}),f.opts.gradients&&t.ashadow.css({width:r,height:u}),i._backGradient.call(this)&&t.bshadow.css({width:r,height:u}));t.parent.is(":visible")&&(f=b(t.parent[0]),t.fwrapper.css({top:f.top,left:f.left}),f=b(t.opts.turn[0]),t.fparent.css({top:-f.top,left:-f.left}));this.flip("z",t.opts["z-index"])}},_addPageWrapper:function(){var t=this.data().f,e=t.opts.turn.data(),u=this.parent(),r,s;if(t.parent=u,!t.wrapper)switch(t.effect){case"hard":r={};r[o+"transform-style"]="preserve-3d";r[o+"backface-visibility"]="hidden";t.wrapper=n("<div/>",f(0,0,2)).css(r).appendTo(u).prepend(this);t.fpage=n("<div/>",f(0,0,1)).css(r).appendTo(u);e.opts.gradients&&(t.ashadow=n("<div/>",f(0,0,0)).hide().appendTo(u),t.bshadow=n("<div/>",f(0,0,0)));break;case"sheet":r=this.width();s=this.height();Math.round(Math.sqrt(Math.pow(r,2)+Math.pow(s,2)));t.fparent=t.opts.turn.data().fparent;t.fparent||(r=n("<div/>",{css:{"pointer-events":"none"}}).hide(),r.data().flips=0,r.css(f(0,0,"auto","visible").css).appendTo(t.opts.turn),t.opts.turn.data().fparent=r,t.fparent=r);this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"});t.wrapper=n("<div/>",f(0,0,this.css("z-index"))).appendTo(u).prepend(this);t.fwrapper=n("<div/>",f(u.offset().top,u.offset().left)).hide().appendTo(t.fparent);t.fpage=n("<div/>",f(0,0,0,"visible")).css({cursor:"default"}).appendTo(t.fwrapper);e.opts.gradients&&(t.ashadow=n("<div/>",f(0,0,1)).appendTo(t.fpage));i.setData.call(this,t)}i.resize.call(this,!0)},_fold:function(n){var t=this.data().f,rt=t.opts.turn.data(),d=i._c.call(this,n.corner),f=this.width(),s=this.height();switch(t.effect){case"hard":n.x="l"==n.corner?Math.min(Math.max(n.x,0),2*f):Math.max(Math.min(n.x,f),-f);var e,ut,g,pt,st,wt=rt.totalPages,ht=t.opts["z-index"]||wt,gt={overflow:"visible"},nt=d.x?(d.x-n.x)/f:n.x/f,ft=90*nt,ct=90>ft;switch(n.corner){case"l":pt="0% 50%";st="100% 50%";ct?(e=0,ut=0<t.opts.next-1,g=1):(e="100%",ut=t.opts.page+1<wt,g=0);break;case"r":pt="100% 50%";st="0% 50%";ft=-ft;f=-f;ct?(e=0,ut=t.opts.next+1<wt,g=0):(e="-100%",ut=1!=t.opts.page,g=1)}gt[o+"perspective-origin"]=st;t.wrapper.transform("rotateY("+ft+"deg)translate3d(0px, 0px, "+(this.attr("depth")||0)+"px)",st);t.fpage.transform("translateX("+f+"px) rotateY("+(180+ft)+"deg)",pt);t.parent.css(gt);ct?(nt=-nt+1,t.wrapper.css({zIndex:ht+1}),t.fpage.css({zIndex:ht})):(nt-=1,t.wrapper.css({zIndex:ht}),t.fpage.css({zIndex:ht+1}));rt.opts.gradients&&(ut?t.ashadow.css({display:"",left:e,backgroundColor:"rgba(0,0,0,"+.5*nt+")"}).transform("rotateY(0deg)"):t.ashadow.hide(),t.bshadow.css({opacity:-nt+1}),ct?t.bshadow.parent()[0]!=t.wrapper[0]&&t.bshadow.appendTo(t.wrapper):t.bshadow.parent()[0]!=t.fpage[0]&&t.bshadow.appendTo(t.fpage),w(t.bshadow,r(100*g,0),r(100*(-g+1),0),[[0,"rgba(0,0,0,0.3)"],[1,"rgba(0,0,0,0)"]],2));break;case"sheet":var lt=this,et=0,bt,v,b,at,a,vt,ni,h=r(0,0),kt=r(0,0),u=r(0,0),ti=i._foldingPage.call(this);Math.tan(0);var yt=rt.opts.acceleration,dt=t.wrapper.height(),it="t"==n.corner.substr(0,1),k="l"==n.corner.substr(1,1),ot=function(){var t=r(0,0),o=r(0,0);t.x=d.x?d.x-n.x:n.x;t.y=tt?d.y?d.y-n.y:n.y:0;o.x=k?f-t.x/2:n.x+t.x/2;o.y=t.y/2;var e=p-Math.atan2(t.y,t.x),c=e-Math.atan2(o.y,o.x),c=Math.max(0,Math.sin(c)*Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2)));return(et=180*(e/y),u=r(c*Math.sin(e),c*Math.cos(e)),e>p&&(u.x+=Math.abs(u.y*t.y/t.x),u.y=0,Math.round(u.x*Math.tan(y-e))<s))?(n.y=Math.sqrt(Math.pow(s,2)+2*o.x*t.x),it&&(n.y=s-n.y),ot()):(e>p&&(t=y-e,o=dt-s/Math.sin(t),h=r(Math.round(o*Math.cos(t)),Math.round(o*Math.sin(t))),k&&(h.x=-h.x),it&&(h.y=-h.y)),bt=Math.round(u.y/Math.tan(e)+u.x),t=f-bt,o=t*Math.cos(2*e),c=t*Math.sin(2*e),kt=r(Math.round(k?t-o:bt+o),Math.round(it?c:s-c)),rt.opts.gradients&&(a=t*Math.sin(e),t=i._c2.call(lt,n.corner),t=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))/f,ni=Math.sin(p*(1<t?2-t:t)),vt=Math.min(t,1),at=100<a?(a-100)/a:0,v=r(100*(a*Math.sin(e)/f),100*(a*Math.cos(e)/s)),i._backGradient.call(lt)&&(b=r(100*(1.2*a*Math.sin(e)/f),100*(1.2*a*Math.cos(e)/s)),k||(b.x=100-b.x),it||(b.y=100-b.y))),u.x=Math.round(u.x),u.y=Math.round(u.y),!0)};e=function(n,u,e,o){var a=["0","auto"],p=(f-dt)*e[0]/100,d=(s-dt)*e[1]/100,u={left:a[u[0]],top:a[u[1]],right:a[u[2]],bottom:a[u[3]]},a={},g=90!=o&&-90!=o?k?-1:1:0,y=e[0]+"% "+e[1]+"%";lt.css(u).transform(l(o)+c(n.x+g,n.y,yt),y);t.fpage.css(u).transform(l(o)+c(n.x+kt.x-h.x-f*e[0]/100,n.y+kt.y-h.y-s*e[1]/100,yt)+l((180/o-2)*o),y);t.wrapper.transform(c(-n.x+p-g,-n.y+d,yt)+l(-o),y);t.fwrapper.transform(c(-n.x+h.x+p,-n.y+h.y+d,yt)+l(-o),y);rt.opts.gradients&&(e[0]&&(v.x=100-v.x),e[1]&&(v.y=100-v.y),a["box-shadow"]="0 0 20px rgba(0,0,0,"+.5*ni+")",ti.css(a),w(t.ashadow,r(k?100:0,it?0:100),r(v.x,v.y),[[at,"rgba(0,0,0,0)"],[.8*(1-at)+at,"rgba(0,0,0,"+.2*vt+")"],[1,"rgba(255,255,255,"+.2*vt+")"]],3,0),i._backGradient.call(lt)&&w(t.bshadow,r(k?0:100,it?0:100),r(b.x,b.y),[[.6,"rgba(0,0,0,0)"],[.8,"rgba(0,0,0,"+.3*vt+")"],[1,"rgba(0,0,0,0)"]],3))};switch(n.corner){case"tl":n.x=Math.max(n.x,1);ot();e(u,[1,0,0,1],[100,0],et);break;case"tr":n.x=Math.min(n.x,f-1);ot();e(r(-u.x,u.y),[0,0,0,1],[0,0],-et);break;case"bl":n.x=Math.max(n.x,1);ot();e(r(u.x,-u.y),[1,1,0,0],[100,100],-et);break;case"br":n.x=Math.min(n.x,f-1);ot();e(r(-u.x,-u.y),[0,1,1,0],[0,100],et)}}t.point=n},_moveFoldingPage:function(n){var t=this.data().f;if(t){var u=t.opts.turn,r=u.data(),f=r.pagePlace;n?(r=t.opts.next,f[r]!=t.opts.page&&(t.folding&&i._moveFoldingPage.call(this,!1),i._foldingPage.call(this).appendTo(t.fpage),f[r]=t.opts.page,t.folding=r),u.turn("update")):t.folding&&(r.pages[t.folding]?(u=r.pages[t.folding].data().f,r.pageObjs[t.folding].appendTo(u.wrapper)):r.pageWrap[t.folding]&&r.pageObjs[t.folding].appendTo(r.pageWrap[t.folding]),t.folding in f&&(f[t.folding]=t.folding),delete t.folding)}},_showFoldedPage:function(n,t){var f=i._foldingPage.call(this),u=this.data(),r=u.f,e=r.visible,o;if(f){if((!e||!r.point||r.point.corner!=n.corner)&&(f="hover"==r.status||"peel"==r.status||r.opts.turn.data().mouseAction?n.corner:null,e=!1,"prevented"==a("start",this,[r.opts,f])))return!1;if(t?(o=this,u=r.point&&r.point.corner==n.corner?r.point:i._c.call(this,n.corner,1),this.animatef({from:[u.x,u.y],to:[n.x,n.y],duration:500,frame:function(t){n.x=Math.round(t[0]);n.y=Math.round(t[1]);i._fold.call(o,n)}})):(i._fold.call(this,n),u.effect&&!u.effect.turning&&this.animatef(!1)),!e)switch(r.effect){case"hard":r.visible=!0;i._moveFoldingPage.call(this,!0);r.fpage.show();r.opts.shadows&&r.bshadow.show();break;case"sheet":r.visible=!0;r.fparent.show().data().flips++;i._moveFoldingPage.call(this,!0);r.fwrapper.show();r.bshadow&&r.bshadow.show()}return!0}return!1},hide:function(){var n=this.data().f,t=n.opts.turn.data(),r=i._foldingPage.call(this);switch(n.effect){case"hard":t.opts.gradients&&(n.bshadowLoc=0,n.bshadow.remove(),n.ashadow.hide());n.wrapper.transform("");n.fpage.hide();break;case"sheet":0==--n.fparent.data().flips&&n.fparent.hide();this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("");n.wrapper.transform("");n.fwrapper.hide();n.bshadow&&n.bshadow.hide();r.transform("")}return n.visible=!1,this},hideFoldedPage:function(n){var u=this.data().f;if(u.point){var e=this,t=u.point,o=function(){u.point=null;u.status="";e.flip("hide");e.trigger("end",[u.opts,!1])};if(n){var f=i._c.call(this,t.corner),n="t"==t.corner.substr(0,1)?Math.min(0,t.y-f.y)/2:Math.max(0,t.y-f.y)/2,s=r(t.x,t.y+n),h=r(f.x,f.y-n);this.animatef({from:0,to:1,frame:function(n){n=g(t,s,h,f,n);t.x=n.x;t.y=n.y;i._fold.call(e,t)},complete:o,duration:800,hiding:!0})}else this.animatef(!1),o()}},turnPage:function(n){var r=this,t=this.data().f,u=t.opts.turn.data(),n={corner:t.corner?t.corner.corner:n||i._cAllowed.call(this)[0]},f=t.point||i._c.call(this,n.corner,t.opts.turn?u.opts.elevation:0),e=i._c2.call(this,n.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(t){t=g(f,f,e,e,t);n.x=t.x;n.y=t.y;i._showFoldedPage.call(r,n)},complete:function(){r.trigger("end",[t.opts,!0])},duration:u.opts.duration,turning:!0});t.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},corner:function(){return this.data().f.corner},_eventStart:function(n){var t=this.data().f,r=t.opts.turn;if(!t.corner&&!t.disabled&&!this.flip("isTurning")&&t.opts.page==r.data().pagePlace[t.opts.page]){if(t.corner=i._isIArea.call(this,n),t.corner&&i._foldingPage.call(this))return this.trigger("pressed",[t.point]),i._showFoldedPage.call(this,t.corner),!1;t.corner=null}},_eventMove:function(n){var t=this.data().f,r;t.disabled||((n=v?n.originalEvent.touches:[n],t.corner)?(r=t.parent.offset(),t.corner.x=n[0].pageX-r.left,t.corner.y=n[0].pageY-r.top,i._showFoldedPage.call(this,t.corner)):t.hover&&!this.data().effect&&this.is(":visible")&&((n=i._isIArea.call(this,n[0]))?("sheet"==t.effect&&2==n.corner.length||"hard"==t.effect)&&(t.status="hover",t=i._c.call(this,n.corner,t.opts.cornerSize/2),n.x=t.x,n.y=t.y,i._showFoldedPage.call(this,n,!0)):"hover"==t.status&&(t.status="",i.hideFoldedPage.call(this,!0))))},_eventEnd:function(){var n=this.data().f,t=n.corner;!n.disabled&&t&&"prevented"!=a("released",this,[n.point||t])&&i.hideFoldedPage.call(this,!0);n.corner=null},disable:function(n){return i.setData.call(this,{disabled:n}),this},hover:function(n){return i.setData.call(this,{hover:n}),this},peel:function(t,r){var u=this.data().f,f;if(t){if(-1==n.inArray(t,s.all))throw e("Corner "+t+" is not permitted");-1!=n.inArray(t,i._cAllowed.call(this))&&(f=i._c.call(this,t,u.opts.cornerSize/2),u.status="peel",i._showFoldedPage.call(this,{corner:t,x:f.x,y:f.y},r))}else u.status="",i.hideFoldedPage.call(this,r);return this}};window.requestAnim=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)};n.extend(n.fn,{flip:function(){return d(n(this[0]),i,arguments)},turn:function(){return d(n(this[0]),t,arguments)},transform:function(n,t){var i={};return t&&(i[o+"transform-origin"]=t),i[o+"transform"]=n,this.css(i)},animatef:function(t){var i=this.data();if(i.effect&&i.effect.stop(),t){t.to.length||(t.to=[t.to]);t.from.length||(t.from=[t.from]);for(var f=[],u=t.to.length,e=!0,s=this,h=(new Date).getTime(),o=function(){if(i.effect&&e){for(var r=[],c=Math.min(t.duration,(new Date).getTime()-h),n=0;n<u;n++)r.push(i.effect.easing(1,c,t.from[n],f[n],t.duration));t.frame(1==u?r[0]:r);c==t.duration?(delete i.effect,s.data(i),t.complete&&t.complete()):window.requestAnim(o)}},r=0;r<u;r++)f.push(t.to[r]-t.from[r]);i.effect=n.extend({stop:function(){e=!1},easing:function(n,t,i,r,u){return r*Math.sqrt(1-(t=t/u-1)*t)+i}},t);this.data(i);o()}else delete i.effect}});n.isTouch=v;n.mouseEvents=h;n.cssPrefix=nt;n.cssTransitionEnd=function(){var n,i=document.createElement("fakeelement"),t={transition:"transitionend",OTransition:"oTransitionEnd",MSTransition:"transitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(n in t)if(void 0!==i.style[n])return t[n]};n.findPos=b})(jQuery);
/*
//# sourceMappingURL=turn.min.js.map
*/