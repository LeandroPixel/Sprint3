var oAluno={jqThis:null,ListStatus:null,ListSinc:[],evento_click:"click",seletor_geral:".conteudo-geral",bootstrap_table:"#table-alunos-list",div_dados_agendamento:"#div-dados-agendamento",btn_close:".btn-close",btn_ok:".btn-ok",progressBar:"#progressBar",url_api_agendamento:(oGeral.string_url_base_aplicacao||oInicial.BaseUrlAplicacao)+"/api/Agendamento/Agendar",url_api_change_status:(oGeral.string_url_base_aplicacao||oInicial.BaseUrlAplicacao)+"/api/Agendamento/ChangeStatus",url_view_photos:(oGeral.string_url_base_aplicacao||oInicial.BaseUrlAplicacao)+"/Produtos",url_api_aluno_sync:(oGeral.string_url_base_aplicacao||oInicial.BaseUrlAplicacao)+"/api/Alunos/Sync",cookie_user_name:null,indexDBON:!1,Titulo_Modal:"",TotalProcessosSync:3,Carregar:function(n,t){var i=this;i.jqThis=jQuery(i.seletor_geral);i.ListStatus=n;i.jqThis.length&&i.CarregarEventos();i.cookie_user_name=t},CarregarEventos:function(){var n=this,t=n.jqThis.find(n.bootstrap_table);t.on("post-body.bs.table",function(){n.LoadDatePicker()});t.on("load-success.bs.table",function(){n.VerifyIfUserIsSynced()});$(window).resize(function(){n.WindowResize()})},Data_Agendamento:function(n,t){var f=t.AlunoID,u="datapicker_"+f,i="<div id='"+u+"' class='div-input-date-picker'> <input onfocus='blur();' class='input-datepicker form-control datetimepicker date-agendamento-"+t.AlunoTurmaID+" fontSizeOpt' type='text' value_old='$Data' value='$Data' StatusIDAgendamento="+t.StatusIDAgendamento+" VendedorID='"+t.VendedorID+"'AlunoTurmaID='"+t.AlunoTurmaID+"'>  <button class='mdl-button mdl-js-button mdl-button--icon btn-data-picker' onclick=javascript:oAluno.ShowDataPickerAgendamento('"+u+"')> <i class='material-icons'>more_horiz<\/i> <\/button> <\/div>",r;return n!=null&&n!=undefined&&n!=""?(r=oUtil.FormatDate2(n),i=i.replace("$Data",r),i.replace("$Data",r)):(i=i.replace("$Data","Agendar"),i.replace("$Data","Agendar"))},LoadDatePicker:function(){var n=this,t=n.jqThis.find(".datetimepicker");config=oUtil.GetConfigDateTimePicker();config.onSelectDate=function(t,i){return n.ChangeDate(t,i)};config.onClose=function(t,i){return n.ChangeDate(t,i)};t.datetimepicker(config)},PopAgendamentoCancelar:function(n,t){var i=this,u=i.jqThis.find(".date-agendamento-"+n),r;u.val(t);r=$(i.div_dados_agendamento);r.modal("hide")},PopAgendamentoOk:function(n,t,i,r,u){var f=this,e=$(f.div_dados_agendamento);e.modal("hide");r.attr("StatusIDAgendamento","-1");oAluno.DoChangeDate(n,t,i,r,u)},ChangeDate:function(n,t){var e=t.attr("VendedorID"),r=t.attr("AlunoTurmaID"),o=t.attr("value_old"),u=t.attr("StatusIDAgendamento"),f=t.val(),i;if(o!=f){if(u==7){i=$(_this.div_dados_agendamento);i.find(_this.btn_close).unbind(_this.evento_click);i.find(_this.btn_close).on(_this.evento_click,function(){return _this.PopAgendamentoCancelar(r,o),!1});i.find(_this.btn_ok).unbind(_this.evento_click);i.find(_this.btn_ok).on(_this.evento_click,function(){return _this.PopAgendamentoOk(f,e,r,t,u),!1});return i.modal(),!0}return oAluno.DoChangeDate(f,e,r,t,u),!1}return!0},DoChangeDate:function(n,t,i,r,u){var f=this;info={data:n,vendedorID:t,alunoTurmaID:i};$.ajax({type:"POST",url:f.url_api_agendamento,data:JSON.stringify(info),headers:oUtil.GetToken(),contentType:"application/json",beforeSend:function(){oUtil.ShowLoader(!0)}}).done(function(e){var o,s;e.Sucesso&&(r.attr("value_old",n),e.Obj.Status!=u&&(o=f.jqThis.find(".alter-status-"+i),nameStatus=f.GetNameStatus(e.Obj.Status),o.html(f.ReturnDropStatus(nameStatus,e.Obj.Status,t,i,!0))),s=f.jqThis.find("#datapicker_"+i+" .datetimepicker"),s.datetimepicker("toggle"),oUtil.ShowModalGeral("<i class='material-icons ico-done'>done<\/i> Aluno",e.Mensagem))}).fail(function(n){oUtil.ShowModalError("","",n,"Aluno")}).always(function(){oUtil.ShowLoader(!1)})},GetNameStatus:function(n){for(var i,r=this,u=null,t=0;t<r.ListStatus.length;t++)if(i=r.ListStatus[t],i.ID==n){u=i.Descricao;break}return u},ShowDataPickerAgendamento:function(n){var t=this,i=t.jqThis.find("#"+n+" .datetimepicker");i.datetimepicker("show")},BtnVisualizarFotos:function(n,t){var u=oAluno,r="lnkGotoProducts"+t.AlunoTurmaID+"_"+t.BrandID,i="data-aluno_turma_id='"+t.AlunoTurmaID+"' data-user_id_vendedor='"+t.UserIDvENDEDOR+"' ";return i+="data-aluno_id = '"+t.AlunoID+"' data-turma_id = '"+t.TurmaID+"'","<a id='"+r+"' "+i+' onclick="javascript:{oAluno.OpenProducts('+t.AlunoTurmaID+","+t.UserIDvENDEDOR+","+t.AlunoID+","+t.TurmaID+",'"+n+"','"+t.NomeAluno+"','"+t.NomeTurma+"')}\" href='#' class='mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored fontSizeOpt'>Projetos<\/a>"},Status:function(n,t){var i=t.VendedorID,r=t.AlunoTurmaID;return oAluno.ReturnDropStatus(n,t.StatusIDAgendamento,i,r)},ReturnDropStatus:function(n,t,i,r,u){u==undefined&&(u=!1);var f="      <button class='btn btn-default dropdown-toggle fontSizeOpt' type='button' id='dropdownMenu_"+r+"' data-toggle='dropdown' aria-haspopup='true' aria-expanded='true'>         "+n+"        <span class='caret'><\/span>       <\/button>       <ul class='dropdown-menu' aria-labelledby='dropdownMenu_"+r+"'> "+oAluno.ReturnStatusOptions(t,i,r)+"      <\/ul> ";return u==!1?"<div class='dropdown alter-status-"+r+"'> "+f+"<\/div> ":f},ReturnStatusOptions:function(n,t,i){for(var r,f="",u=0;u<oAluno.ListStatus.length;u++)r=oAluno.ListStatus[u],n!=r.ID&&(f+="<li><a href='javascript:oAluno.DoChangeStatus("+r.ID+","+t+","+i+")'>"+r.Descricao+"<\/a><\/li>");return f},DoChangeStatus:function(n,t,i){var r=this;info={statusID:n,vendedorID:t,alunoTurmaID:i};$.ajax({type:"POST",url:r.url_api_change_status,data:JSON.stringify(info),headers:oUtil.GetToken(),contentType:"application/json",beforeSend:function(){oUtil.ShowLoader(!0)}}).done(function(n){var t;n.Sucesso&&(oUtil.ShowModalGeral("<i class='material-icons ico-done'>done<\/i> Aluno",n.Mensagem),t=r.jqThis.find(r.bootstrap_table),t.bootstrapTable("refresh",null))}).fail(function(n){oUtil.ShowModalError("","",n,"Aluno")}).always(function(){oUtil.ShowLoader(!1)})},BtnSync:function(n,t){var u=this,i="SINCRONIZAR",r="CustomButtom";return oAluno.ListSinc[t.AlunoTurmaID]!=undefined&&oAluno.ListSinc[t.AlunoTurmaID]=="SINCRONIZADO"&&(i=oAluno.ListSinc[t.AlunoTurmaID],r="CustomButtomSync"),"<button id='btn-sync-"+t.AlunoTurmaID+"' class='mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect "+r+"'  onclick=javascript:oAluno.SyncOffline("+t.AlunoID+","+t.TurmaID+","+t.VendedorID+","+t.AlunoTurmaID+","+t.AlbumID+")> "+i+"<!--<i class='material-icons'>file_download<\/i> --><\/button> "},GetTablesToSync:function(){var n=[];return n.push({Name:dbControl.v_GRD_TabelaPreco.Name,LastSync:dbControl.v_GRD_TabelaPreco.LastSync}),n.push({Name:dbControl.v_GRD_Products.Name,LastSync:dbControl.v_GRD_Products.LastSync}),n.push({Name:dbControl.GRD_AlunoTurma_Photos.Name,LastSync:dbControl.GRD_AlunoTurma_Photos.LastSync}),n.push({Name:dbControl.GRD_ORDER_PRODUCT_PHOTOS.Name,LastSync:dbControl.GRD_ORDER_PRODUCT_PHOTOS.LastSync}),n.push({Name:dbControl.GRD_CART_PRODUCT.Name,LastSync:dbControl.GRD_CART_PRODUCT.LastSync}),n.push({Name:dbControl.Photos_Album.Name,LastSync:dbControl.Photos_Album.LastSync}),n.push({Name:dbControl.GRD_Pacote.Name,LastSync:dbControl.GRD_Pacote.LastSync}),n.push({Name:dbControl.GRD_Pacote_Products.Name,LastSync:dbControl.GRD_Pacote_Products.LastSync}),n.push({Name:dbControl.GRD_Turma_Pacote.Name,LastSync:dbControl.GRD_Turma_Pacote.LastSync}),n.push({Name:dbControl.GRD_Aluno_Pacote.Name,LastSync:dbControl.GRD_Aluno_Pacote.LastSync}),n},OpenProducts:function(n,t,i,r,u,f,e){var o=this;o.VerifyDadosIndexDB(n,t,i,r,u,f,e)},ShowPopRemoveDadosIndexDB:function(n,t,i,r,u,f,e){var o=this,s=$("#div-dados-sync");s.find(".btn-ok").unbind(o.evento_click);s.find(".btn-ok").on(o.evento_click,function(){return o.GetDadosToDeleteIndexDB(n,t,i,r,u,f,e),!1});s.modal()},GetDadosToDeleteByAluno:function(n,t,i,r){var o=this,u,f;try{if(n!=undefined||n!=null||n.length>0)for(u=0;u<n.length;u++)f=n[u],f.AlunoTurmaID==t&&i.push({dado:f,NameTable:r})}catch(e){oUtil.ShowModalError("","Erro no metodo: GetDadosToDeleteByAluno erro "+e)}},DeleteDadosIndexDB:function(n,t,i,r,u,f,o,s,h,c,l){var y=this,w,b,p,v,a;try{if(w=o.length,b=dbControl.Photos_Album.Name,w>0){for(p=0;p<w;p++)dbControl.DeleteByIndex(b,o[p],function(o,a){if(o==!1){oUtil.ShowModalError("","Erro metodo: DeleteByIndex -> t:"+b+" -> erro "+e);return}o==!0&&a+1==w&&y.DeleteDadosIndexDB(n,t,i,r,u,f,[],s,h,c,l)},p);return}if(h==s){y.OpenProductsDO(n,t,i,r,u,c,l);return}v=f[s];switch(v.NameTable.toLowerCase()){case"v_grd_listaalunos":a=dbControl[v.NameTable].Name;dbControl.DeleteByIndexComplex(a,v.dado,function(e){if(e==!1){oUtil.ShowModalError("","Erro metodo: DeleteByIndexComplex -> t:"+a);return}s++;y.DeleteDadosIndexDB(n,t,i,r,u,f,[],s,h,c,l)});return;case"grd_alunoturma_photos":a=dbControl[v.NameTable].Name;dbControl.DeleteByIndex(a,v.dado.ID,function(e){if(e==!1){oUtil.ShowModalError("","Erro metodo: DeleteByIndex -> t:"+a);return}s++;y.DeleteDadosIndexDB(n,t,i,r,u,f,[],s,h,c,l)});return;case"grd_order_product_photos":a=dbControl[v.NameTable].Name;dbControl.DeleteByIndexComplex(a,v.dado,function(e){if(e==!1){oUtil.ShowModalError("","Erro metodo: DeleteByIndexComplex -> t:"+a);return}s++;y.DeleteDadosIndexDB(n,t,i,r,u,f,[],s,h,c,l)});return;case"grd_cart_product":a=dbControl[v.NameTable].Name;dbControl.DeleteByIndexComplex(a,v.dado,function(e){if(e==!1){oUtil.ShowModalError("","Erro metodo: DeleteByIndexComplex -> t:"+a);return}s++;y.DeleteDadosIndexDB(n,t,i,r,u,f,[],s,h,c,l)});return;default:throw"Tabela nao implementada para delecao "+v.NameTable;}}catch(e){oUtil.ShowModalError("","Erro no metodo: DeleteDadosIndexDB erro "+e)}},GetDadosToDeleteIndexDB:function(n,t,i,r,u,f,e){var h=this;try{oUtil.ShowLoader(!0);var s=[],c=[],o=dbControl.v_GRD_ListaAlunos.Name;dbControl.SelectALL(o,function(l){h.GetDadosToDeleteByAluno(l,n,s,o);o=dbControl.GRD_AlunoTurma_Photos.Name;dbControl.SelectALL(o,function(l){var a,v;for(h.GetDadosToDeleteByAluno(l,n,s,o),a=0;a<s.length;a++)v=s[a],v.NameTable==o&&c.push(v.dado.PhotoID);o=dbControl.GRD_ORDER_PRODUCT_PHOTOS.Name;dbControl.SelectALL(o,function(l){h.GetDadosToDeleteByAluno(l,n,s,o);o=dbControl.GRD_CART_PRODUCT.Name;dbControl.SelectALL(o,function(l){h.GetDadosToDeleteByAluno(l,n,s,o);h.DeleteDadosIndexDB(n,t,i,r,u,s,c,0,s.length,f,e)})})})})}catch(l){oUtil.ShowModalError("","Erro no metodo: GetDadosToDeleteIndexDB erro "+l)}},EhDoAluno:function(n,t,i,r,u,f,e,o){var l=this,s,h,c;try{if(s=!1,n==undefined||n==null||n.length==0)return s;for(h=0;h<n.length;h++)if(c=n[h],c.AlunoTurmaID==t){s=!0;break}return s&&l.ShowPopRemoveDadosIndexDB(t,i,r,u,f,e,o),s}catch(a){oUtil.ShowModalError("","Erro no metodo: EhDoAluno erro "+a)}},VerifyDadosIndexDB:function(n,t,i,r,u,f,e){var s=this,o;try{o=dbControl.v_GRD_ListaAlunos.Name;dbControl.SelectALL(o,function(h){s.EhDoAluno(h,n,t,i,r,u,f,e)||(o=dbControl.GRD_AlunoTurma_Photos.Name,dbControl.SelectALL(o,function(h){s.EhDoAluno(h,n,t,i,r,u,f,e)||(o=dbControl.GRD_ORDER_PRODUCT_PHOTOS.Name,dbControl.SelectALL(o,function(h){s.EhDoAluno(h,n,t,i,r,u,f,e)||(o=dbControl.GRD_CART_PRODUCT.Name,dbControl.SelectALL(o,function(o){s.EhDoAluno(o,n,t,i,r,u,f,e)||s.OpenProductsDO(n,t,i,r,u,f,e)}))}))}))})}catch(h){oUtil.ShowModalError("","Erro no metodo: VerifyDadosIndexDB erro "+h)}},OpenProductsDO:function(n,t,i,r,u,f,e){var o={ID:t,AlunoTurmaID:n,UserIdVendedor:t,AlunoID:i,TurmaID:r,AlunoTurmaID_Cript:u,NomeAluno:f,NomeTurma:e,Origem:"ONLINE"};sessionStorage.setItem("config_turma_aluno",JSON.stringify(o));window.location=oAluno.url_view_photos+"?a="+u},SyncOffline:function(n,t,i,r,u){var f=this,o=[],e;o.push({AlunoID:n,TurmaID:t,VendedorID:i,AlunoTurmaID:r,AlbumID:u});e={Alunos:o,Tabelas:f.GetTablesToSync()};$.ajax({type:"POST",url:f.url_api_aluno_sync,data:JSON.stringify(e),headers:oUtil.GetToken(),contentType:"application/json",beforeSend:function(){oUtil.ShowProgress(!0);oUtil.AddStepProgress(1,f.TotalProcessosSync)},xhr:function(){var n=new window.XMLHttpRequest;return n.upload.addEventListener("progress",function(n){if(n.lengthComputable){var t=n.loaded/n.total;oUtil.UpdateProgressBar(t*100)}},!1),n.addEventListener("progress",function(n){if(n.lengthComputable){var t=n.loaded/n.total;t<1&&oUtil.AddStepProgress(2,f.TotalProcessosSync);oUtil.UpdateProgressBar(t*100)}},!1),n}}).done(function(n){if(f.Titulo_Modal="Aluno",n==null||n==undefined||n.length==0){oUtil.ShowModalGeral(f.Titulo_Modal,"Erro ao sincronizar os dados (dados não encontrados)");return}oUtil.UpdateProgressBar(0);oUtil.AddStepProgress(3,f.TotalProcessosSync);oAluno.SaveIndexedDBAlunos(n,0,e.Alunos.length)}).fail(function(n){oUtil.ShowProgress(!1);oUtil.ShowModalError("","",n,"Aluno")}).always(function(){})},SaveIndexedDBAlunos:function(n,t,i){var r=oAluno,f,u,e;try{if(f=dbControl.v_GRD_TabelaPreco.Name,i==0){r.SaveIndexedDBPrecos(n,0,n[f].length);return}u=dbControl.v_GRD_ListaAlunos.Name;e=n[u][t];dbControl.SelectByIndexComplex(u,e,function(o){var s=o!=null&&o!=undefined&&o.length>0;if(s){dbControl.UpdateByIndexComplex(u,e,function(e){r.TrataRetExecIndexDB(e,"update",u,r.Titulo_Modal)&&(t++,t<i?r.SaveIndexedDBAlunos(n,t,i):r.SaveIndexedDBPrecos(n,0,n[f].length))});return}dbControl.Insert(u,e,function(e){r.TrataRetExecIndexDB(e,"insert",u,r.Titulo_Modal)&&(t++,t<i?r.SaveIndexedDBAlunos(n,t,i):r.SaveIndexedDBPrecos(n,0,n[f].length))})})}catch(o){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,o)}},SaveIndexedDBPrecos:function(n,t,i){var r=oAluno,f,u;try{if(oUtil.UpdateProgressBar(15),f=dbControl.v_GRD_Products.Name,i==0){r.SaveIndexedDBProducts(n,0,n[f].length);return}u=dbControl.v_GRD_TabelaPreco.Name;dbControl.DeleteAllRows(u,function(t){r.TrataRetExecIndexDB(t,"DeleteAllRows",u,r.Titulo_Modal)&&dbControl.InsertArray(u,n[u],function(t){r.TrataRetExecIndexDB(t,"InsertArray",u,r.Titulo_Modal)&&r.SaveIndexedDBProducts(n,0,n[f].length)})})}catch(e){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,e)}},SaveIndexedDBProducts:function(n,t,i){var r=oAluno,f,u;try{if(oUtil.UpdateProgressBar(38.5),f=dbControl.GRD_AlunoTurma_Photos.Name,i==0){r.SaveIndexedDBAlunoTurmaPhotos(n,0,n[f].length);return}u=dbControl.v_GRD_Products.Name;dbControl.DeleteAllRows(u,function(t){r.TrataRetExecIndexDB(t,"DeleteAllRows",u,r.Titulo_Modal)&&dbControl.InsertArray(u,n[u],function(t){r.TrataRetExecIndexDB(t,"InsertArray",u,r.Titulo_Modal)&&r.SaveIndexedDBAlunoTurmaPhotos(n,0,n[f].length)})})}catch(e){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,e)}},SaveIndexedDBAlunoTurmaPhotos:function(n,t,i){var r=oAluno,f;try{if(oUtil.UpdateProgressBar(47),f=dbControl.GRD_ORDER_PRODUCT_PHOTOS.Name,i==0){r.SaveIndexedDBOrderProductPhotos(n,0,n[f].length);return}var u=dbControl.GRD_AlunoTurma_Photos.Name,e=n[u],o=e[t];dbControl.DeleteByHintIndexComplex(u,"AlunoTurmaID",o,function(t){r.TrataRetExecIndexDB(t,"DeleteByHintIndexComplex",u,r.Titulo_Modal)&&dbControl.InsertArray(u,e,function(t){r.TrataRetExecIndexDB(t,"InsertArray",u,r.Titulo_Modal)&&r.SaveIndexedDBOrderProductPhotos(n,0,n[f].length)})})}catch(s){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,s)}},SaveIndexedDBOrderProductPhotos:function(n,t,i,r){var u=oAluno,e,f;try{if(oUtil.UpdateProgressBar(55.5),r==undefined&&(r=!1),e=dbControl.GRD_CART_PRODUCT.Name,f=dbControl.GRD_ORDER_PRODUCT_PHOTOS.Name,i==0){u.SaveIndexedDBCartProducts(n,0,n[e].length);return}var o=n[f],s=o[t];dbControl.DeleteByHintIndexComplex(f,"AlunoTurmaID",s,function(t){u.TrataRetExecIndexDB(t,"DeleteByHintIndexComplex",f,u.Titulo_Modal)&&dbControl.InsertArray(f,o,function(t){u.TrataRetExecIndexDB(t,"InsertArray",f,u.Titulo_Modal)&&u.SaveIndexedDBCartProducts(n,0,n[e].length)})})}catch(h){u.TrataErroSaveIndexedDB(u.Titulo_Modal,f,h)}},SaveIndexedDBCartProducts:function(n,t,i,r){var u=oAluno;try{oUtil.UpdateProgressBar(64);r==undefined&&(r=!1);var e=dbControl.Photos_Album.Name,f=dbControl.GRD_CART_PRODUCT.Name,o=n[f],s=o[t];if(i==0){u.SaveIndexedDBPhotosAlbum(n,0,n[e].length);return}dbControl.DeleteByHintIndexComplex(f,"AlunoTurmaID",s,function(t){u.TrataRetExecIndexDB(t,"DeleteByHintIndexComplex",f,u.Titulo_Modal)&&dbControl.InsertArray(f,o,function(t){u.TrataRetExecIndexDB(t,"InsertArray",f,u.Titulo_Modal)&&u.SaveIndexedDBPhotosAlbum(n,0,n[e].length)})})}catch(h){u.TrataErroSaveIndexedDB(u.Titulo_Modal,f,h)}},SaveIndexedDBPhotosAlbum:function(n,t,i){var r=oAluno,e,u,f;try{if(oUtil.UpdateProgressBar(72.5),e=dbControl.GRD_Pacote.Name,i==0){r.SaveIndexedDBGRD_Pacote(n,0,n[e].length);return}u=dbControl.Photos_Album.Name;f=n[u][t];dbControl.SelectByIndex(u,f.PhotoID,function(o){var s=o!=null&&o!=undefined;if(s){dbControl.UpdateByIndex(u,f.PhotoID,f,function(f){r.TrataRetExecIndexDB(f,"update",u,r.Titulo_Modal)&&(t++,t<i?r.SaveIndexedDBPhotosAlbum(n,t,i):r.SaveIndexedDBGRD_Pacote(n,0,n[e].length))});return}dbControl.Insert(u,f,function(f){r.TrataRetExecIndexDB(f,"insert",u,r.Titulo_Modal)&&(t++,t<i?r.SaveIndexedDBPhotosAlbum(n,t,i):r.SaveIndexedDBGRD_Pacote(n,0,n[e].length))})})}catch(o){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,o)}},SaveIndexedDBGRD_Pacote:function(n,t,i){var r=oAluno,f,u;try{if(oUtil.UpdateProgressBar(81),f=dbControl.GRD_Pacote_Products.Name,i==0){r.SaveIndexedDBGRD_Pacote_Products(n,0,n[f].length);return}u=dbControl.GRD_Pacote.Name;dbControl.DeleteAllRows(u,function(t){r.TrataRetExecIndexDB(t,"DeleteAllRows",u,r.Titulo_Modal)&&dbControl.InsertArray(u,n[u],function(t){r.TrataRetExecIndexDB(t,"InsertArray",u,r.Titulo_Modal)&&r.SaveIndexedDBGRD_Pacote_Products(n,0,n[f].length)})})}catch(e){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,e)}},SaveIndexedDBGRD_Pacote_Products:function(n,t,i){var r=oAluno,f,u;try{if(oUtil.UpdateProgressBar(89.5),f=dbControl.GRD_Turma_Pacote.Name,i==0){r.SaveIndexedDBGRD_Turma_Pacote(n,0,n[f].length);return}u=dbControl.GRD_Pacote_Products.Name;dbControl.DeleteAllRows(u,function(t){r.TrataRetExecIndexDB(t,"DeleteAllRows",u,r.Titulo_Modal)&&dbControl.InsertArray(u,n[u],function(t){r.TrataRetExecIndexDB(t,"InsertArray",u,r.Titulo_Modal)&&r.SaveIndexedDBGRD_Turma_Pacote(n,0,n[f].length)})})}catch(e){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,e)}},SaveIndexedDBGRD_Turma_Pacote:function(n,t,i){var r=oAluno,f,u;try{if(oUtil.UpdateProgressBar(93),f=dbControl.GRD_Aluno_Pacote.Name,i==0){r.SaveIndexedDBGRD_Aluno_Pacote(n,0,n[f].length);return}u=dbControl.GRD_Turma_Pacote.Name;dbControl.DeleteAllRows(u,function(t){r.TrataRetExecIndexDB(t,"DeleteAllRows",u,r.Titulo_Modal)&&dbControl.InsertArray(u,n[u],function(t){r.TrataRetExecIndexDB(t,"InsertArray",u,r.Titulo_Modal)&&(console.log("Finalizou..."),r.SaveIndexedDBGRD_Aluno_Pacote(n,0,n[f].length))})})}catch(e){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,e)}},SaveIndexedDBGRD_Aluno_Pacote:function(n,t,i){var r=oAluno,u;try{if(oUtil.UpdateProgressBar(95),i==0){r.CompleteSaveIndexedDB(r.Titulo_Modal);return}u=dbControl.GRD_Aluno_Pacote.Name;dbControl.DeleteAllRows(u,function(t){r.TrataRetExecIndexDB(t,"DeleteAllRows",u,r.Titulo_Modal)&&dbControl.InsertArray(u,n[u],function(n){r.TrataRetExecIndexDB(n,"InsertArray",u,r.Titulo_Modal)&&r.CompleteSaveIndexedDB(r.Titulo_Modal)})})}catch(f){r.TrataErroSaveIndexedDB(r.Titulo_Modal,u,f)}},TrataErroSaveIndexedDB:function(n,t,i,r){oUtil.ShowModalGeral(n,"Erro ao sincronizar os dados "+t+" erro: "+r)},TrataRetExecIndexDB:function(n,t,i,r){var u=!(n==null||n==!1);return u==!1&&oUtil.ShowModalGeral(r,"Erro "+i+" ("+t+")"),u},VerifyIfUserIsSynced:function(){var n=oAluno,t;if(n.indexDBON==!1){oUtil.ShowLoader(!1);return}t=dbControl.v_GRD_ListaAlunos.Name;dbControl.SelectALL(t,function(t){var i,u,r;if(t!=null&&t.length>0)for(i=oOffline.getCookie(oAluno.cookie_user_name),i=JSON.parse(i),u=0;u<t.length;u++)r=t[u],r.UserIDvENDEDOR==i.User_ID&&r.BrandID==i.Brand_ID&&(n.jqThis.find($("#btn-sync-"+r.AlunoTurmaID)).removeClass("CustomButtom").addClass("CustomButtomSync").text("SINCRONIZADO"),n.ListSinc[r.AlunoTurmaID]="SINCRONIZADO");oUtil.ShowLoader(!1)})},CompleteSaveIndexedDB:function(n){var t=this;oUtil.UpdateProgressBar(100);oUtil.ShowModalGeral("<i class='material-icons ico-done'>done<\/i> "+n,"Dados sincronizados com sucesso");t.VerifyIfUserIsSynced()},BtnDetalhes:function(n,t){var i="onclick=\"javascript:oAluno.ShowPop('"+t.NomeAluno+"','"+t.NomeTurma+"','"+t.EnderecoAluno+"','"+t.TelefoneAluno+"')\"";return"<div class='boxDetalhes'><div class='dvLnk'><a href='#'"+i+"><span class='glyphicon glyphicon-zoom-in' aria-hidden='true'><\/span><\/a><\/div><div class='dvBoxConteudo'><div class='dvNome'><span class='spNome'>"+n+" <\/span><\/div><div class='dvDetalhes'>Ver Detalhes<\/div> <div class='clear'><\/div><\/div>"},ShowPop:function(n,t,i,r){var e=this,u=$(".div-modal-geral"),f="<table class='tabelaDetalhes'><tr><th>NOME<\/td><td>"+n+"<\/td><\/tr><tr><th>TURMA<\/td><td>"+t+"<\/td><\/tr><tr><th>ENDEREÇO<\/td><td>"+i+"<\/td><\/tr><tr><th>TELEFONE<\/td><td>"+r+"<\/td><\/tr><\/table>";u.find(".modal-body").html(f);oUtil.ShowLoader(!1);oUtil.ShowProgress(!1);u.modal()},WindowResize:function(){var t=$(window).width(),n=this;t<=1100?n.jqThis.find(n.bootstrap_table+"[data-field='QtdFotos']").attr("data-visible","false"):n.jqThis.find(n.bootstrap_table+"[data-field='QtdFotos']").attr("data-visible","true")}};jQuery(document).ready(function(){oUtil.ShowLoader(!0);oAluno.Carregar(ListStatus,cookie_user_name)});dbControl.CallbackOpenOnSuccess=function(){oAluno.indexDBON=!0;jQuery(document).ready(function(){oAluno.VerifyIfUserIsSynced()})};
/*
//# sourceMappingURL=aluno.min.js.map
*/