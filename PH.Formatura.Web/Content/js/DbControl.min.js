var dbControl={DbName:"FormaturaDB",v_GRD_ListaAlunos:{Name:"v_GRD_ListaAlunos",keyPath:["AlunoID","TurmaID","BrandID"],LastSync:"2015-01-01",Dominio:!1,Indexes:[{Name:"AlunoTurmaID",Unique:!1,KeyPath:["AlunoTurmaID"]}]},v_GRD_TabelaPreco:{Name:"v_GRD_TabelaPreco",keyPath:["TurmaPrecoID"],LastSync:"2015-01-01",Dominio:!0,Indexes:[]},v_GRD_Products:{Name:"v_GRD_Products",keyPath:["ProductConfigID"],LastSync:"2015-01-01",Dominio:!0,Indexes:[]},GRD_AlunoTurma_Photos:{Name:"GRD_AlunoTurma_Photos",keyPath:["ID"],LastSync:"2015-01-01",Dominio:!1,Indexes:[{Name:"AlunoTurmaID",Unique:!1,KeyPath:["AlunoTurmaID"]}]},GRD_ORDER_PRODUCT_PHOTOS:{Name:"GRD_ORDER_PRODUCT_PHOTOS",keyPath:["AlunoTurmaID","ProductID","PhotoID"],LastSync:"2015-01-01",Dominio:!1,Indexes:[{Name:"ProductIDAlunoTurmaID",Unique:!1,KeyPath:["ProductID","AlunoTurmaID"]},{Name:"AlunoTurmaID",Unique:!1,KeyPath:["AlunoTurmaID"]}]},GRD_CART_PRODUCT:{Name:"GRD_CART_PRODUCT",keyPath:["AlunoTurmaID","ProductID","UserID"],LastSync:"2015-01-01",Dominio:!1,Indexes:[{Name:"AlunoTurmaID",Unique:!1,KeyPath:["AlunoTurmaID"]}]},Photos_Album:{Name:"Photos_Album",keyPath:["PhotoID"],LastSync:"2015-01-01",Dominio:!1,Indexes:[]},TableSyncControl:{Name:"TableSyncControl",keyPath:["TableName"],LastSync:"2015-01-01",Dominio:!1,Indexes:[]},Orders_Pending:{Name:"Orders_Pending",keyPath:["ID"],LastSync:"2015-01-01",Dominio:!1,Indexes:[]},GRD_Pacote:{Name:"GRD_Pacote",keyPath:["ID"],LastSync:"2015-01-01",Dominio:!0,Indexes:[]},GRD_Pacote_Products:{Name:"GRD_Pacote_Products",keyPath:["GRD_PacoteID","ProductID"],LastSync:"2015-01-01",Dominio:!0,Indexes:[{Name:"GRD_PacoteID",Unique:!1,KeyPath:["GRD_PacoteID"]}]},GRD_Turma_Pacote:{Name:"GRD_Turma_Pacote",keyPath:["GRD_PacoteID","GRD_TurmaID"],LastSync:"2015-01-01",Dominio:!0,Indexes:[{Name:"GRD_TurmaID",Unique:!1,KeyPath:["GRD_TurmaID"]}]},GRD_Aluno_Pacote:{Name:"GRD_Aluno_Pacote",keyPath:["GRD_AlunoTurmaID"],LastSync:"2015-01-01",Dominio:!1,Indexes:[]},TransactionMode:{READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},CallbackOpenOnSuccess:undefined,CallbackOpenOnError:undefined,version:59,db:undefined,Open:function(){var i=dbControl,n,t;if(window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,!window.indexedDB)return!1;if(dbControl.db==undefined){for(n=indexedDB.open(dbControl.DbName+dbControl.version.toString(),dbControl.version),t=dbControl.version-20;t<dbControl.version;t++)indexedDB.deleteDatabase(dbControl.DbName+t.toString());n.onerror=function(){retorno=!1;dbControl.CallbackOpenOnError!=undefined&&dbControl.CallbackOpenOnError()};n.onsuccess=function(n){dbControl.db=n.target.result;dbControl.LoadSyncRegisterAll();dbControl.CallbackOpenOnSuccess!=undefined&&dbControl.CallbackOpenOnSuccess()};n.onupgradeneeded=function(n){dbControl.db=n.target.result;try{dbControl.db.objectStoreNames.contains(dbControl.v_GRD_ListaAlunos.Name)&&dbControl.db.deleteObjectStore(dbControl.v_GRD_ListaAlunos.Name);dbControl.db.objectStoreNames.contains(dbControl.v_GRD_TabelaPreco.Name)&&dbControl.db.deleteObjectStore(dbControl.v_GRD_TabelaPreco.Name);dbControl.db.objectStoreNames.contains(dbControl.v_GRD_Products.Name)&&dbControl.db.deleteObjectStore(dbControl.v_GRD_Products.Name);dbControl.db.objectStoreNames.contains(dbControl.GRD_AlunoTurma_Photos.Name)&&dbControl.db.deleteObjectStore(dbControl.GRD_AlunoTurma_Photos.Name);dbControl.db.objectStoreNames.contains(dbControl.GRD_ORDER_PRODUCT_PHOTOS.Name)&&dbControl.db.deleteObjectStore(dbControl.GRD_ORDER_PRODUCT_PHOTOS.Name);dbControl.db.objectStoreNames.contains(dbControl.GRD_CART_PRODUCT.Name)&&dbControl.db.deleteObjectStore(dbControl.GRD_CART_PRODUCT.Name);dbControl.db.objectStoreNames.contains(dbControl.Photos_Album.Name)&&dbControl.db.deleteObjectStore(dbControl.Photos_Album.Name);dbControl.db.objectStoreNames.contains(dbControl.TableSyncControl.Name)&&dbControl.db.deleteObjectStore(dbControl.TableSyncControl.Name);dbControl.db.objectStoreNames.contains(dbControl.Orders_Pending.Name)&&dbControl.db.deleteObjectStore(dbControl.Orders_Pending.Name);dbControl.db.objectStoreNames.contains(dbControl.GRD_Pacote.Name)&&dbControl.db.deleteObjectStore(dbControl.GRD_Pacote.Name);dbControl.db.objectStoreNames.contains(dbControl.GRD_Pacote_Products.Name)&&dbControl.db.deleteObjectStore(dbControl.GRD_Pacote_Products.Name);dbControl.db.objectStoreNames.contains(dbControl.GRD_Turma_Pacote.Name)&&dbControl.db.deleteObjectStore(dbControl.GRD_Turma_Pacote.Name);dbControl.db.objectStoreNames.contains(dbControl.GRD_Aluno_Pacote.Name)&&dbControl.db.deleteObjectStore(dbControl.GRD_Aluno_Pacote.Name)}catch(i){}var t;t=dbControl.db.createObjectStore(dbControl.v_GRD_ListaAlunos.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.v_GRD_ListaAlunos.keyPath)});dbControl.CreateIndex(t,dbControl.v_GRD_ListaAlunos.Indexes);t=dbControl.db.createObjectStore(dbControl.v_GRD_TabelaPreco.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.v_GRD_TabelaPreco.keyPath)});dbControl.CreateIndex(t,dbControl.v_GRD_TabelaPreco.Indexes);t=dbControl.db.createObjectStore(dbControl.v_GRD_Products.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.v_GRD_Products.keyPath)});dbControl.CreateIndex(t,dbControl.v_GRD_Products.Indexes);t=dbControl.db.createObjectStore(dbControl.GRD_AlunoTurma_Photos.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.GRD_AlunoTurma_Photos.keyPath)});dbControl.CreateIndex(t,dbControl.GRD_AlunoTurma_Photos.Indexes);t=dbControl.db.createObjectStore(dbControl.GRD_ORDER_PRODUCT_PHOTOS.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.GRD_ORDER_PRODUCT_PHOTOS.keyPath)});dbControl.CreateIndex(t,dbControl.GRD_ORDER_PRODUCT_PHOTOS.Indexes);t=dbControl.db.createObjectStore(dbControl.GRD_CART_PRODUCT.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.GRD_CART_PRODUCT.keyPath)});dbControl.CreateIndex(t,dbControl.GRD_CART_PRODUCT.Indexes);t=dbControl.db.createObjectStore(dbControl.Photos_Album.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.Photos_Album.keyPath)});dbControl.CreateIndex(t,dbControl.Photos_Album.Indexes);t=dbControl.db.createObjectStore(dbControl.TableSyncControl.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.TableSyncControl.keyPath)});dbControl.CreateIndex(t,dbControl.TableSyncControl.Indexes);t=dbControl.db.createObjectStore(dbControl.Orders_Pending.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.Orders_Pending.keyPath),autoIncrement:!0});dbControl.CreateIndex(t,dbControl.Orders_Pending.Indexes);t=dbControl.db.createObjectStore(dbControl.GRD_Pacote.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.GRD_Pacote.keyPath)});dbControl.CreateIndex(t,dbControl.GRD_Pacote.Indexes);t=dbControl.db.createObjectStore(dbControl.GRD_Pacote_Products.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.GRD_Pacote_Products.keyPath)});dbControl.CreateIndex(t,dbControl.GRD_Pacote_Products.Indexes);t=dbControl.db.createObjectStore(dbControl.GRD_Turma_Pacote.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.GRD_Turma_Pacote.keyPath)});dbControl.CreateIndex(t,dbControl.GRD_Turma_Pacote.Indexes);t=dbControl.db.createObjectStore(dbControl.GRD_Aluno_Pacote.Name,{keyPath:dbControl.ReturnKeyPath(dbControl.GRD_Aluno_Pacote.keyPath)});dbControl.CreateIndex(t,dbControl.GRD_Aluno_Pacote.Indexes);return}}return window.indexedDB},CreateIndex:function(n,t){if(t.length>0)for(var i in t)n.createIndex(t[i].Name,t[i].KeyPath,{unique:t[i].Unique})},GetProperties:function(){var n=[];for(var t in dbControl)typeof dbControl[t]!="function"&&n.push(t);return n},GetKeyPathNames:function(n){for(var i,r=dbControl.GetProperties(),u=null,t=0;t<r.length;t++)if(i=r[t],n==i){u=dbControl[i].keyPath;break}return u},GetKeyPathNamesIndexes:function(n,t){for(var i,u,f=dbControl.GetProperties(),e=null,r=0;r<f.length;r++)if(i=f[r],n==i){for(u in dbControl[i].Indexes)if(dbControl[i].Indexes[u].Name==t){e=dbControl[i].Indexes[u].KeyPath;break}break}return e},GetKeyValues:function(n,t){for(var i,u=[],f=dbControl.GetKeyPathNames(n),r=0;r<f.length;r++)i=f[r],(t[i]!=null||t[i]!=undefined)&&u.push(t[i]);return u},GetKeyValuesIndex:function(n,t,i){for(var r,f=[],e=dbControl.GetKeyPathNamesIndexes(n,t),u=0;u<e.length;u++)r=e[u],(i[r]!=null||i[r]!=undefined)&&f.push(i[r]);return f},ReturnKeyPath:function(n){return n.length==1?n[0]:n},UpdateSyncRegister:function(n,t,i){var r=dbControl,u;i!=!1&&(u={TableName:t,LastSync:oUtil.FormatDateNow()},r.SelectByIndex(n,t,function(i){var f=i!=null&&i!=undefined;if(f){r.UpdateByIndex(n,t,u,function(){r.LoadSyncRegisterAll()});return}r.Insert(n,u,function(){r.LoadSyncRegisterAll()})}))},LoadSyncRegisterAll:function(){var n=dbControl;n.SelectALL(n.TableSyncControl.Name,function(t){if(t!=null&&t!=!1&&t.length!=0)for(var i=0;i<t.length;i++)obj=t[i],n[obj.TableName].Dominio==!0&&(n[obj.TableName].LastSync=obj.LastSync)})},Insert:function(n,t,i,r){var u=dbControl,e=[n],f=dbControl.db.transaction(e,dbControl.TransactionMode.READ_WRITE),o=f.objectStore(n),s=o.add(t);s.onsuccess=function(){};f.oncomplete=function(){u.UpdateSyncRegister(u.TableSyncControl.Name,n,u[n].Dominio);i(!0,r)};f.onerror=function(){i(!1,r)}},InsertArray:function(n,t,i,r){function o(){f<t.length&&(h.add(t[f]).onsuccess=o,f++)}var u=dbControl,s=[n],f=0,e=dbControl.db.transaction(s,dbControl.TransactionMode.READ_WRITE),h=e.objectStore(n);e.oncomplete=function(t){u.UpdateSyncRegister(u.TableSyncControl.Name,n,u[n].Dominio);i(!0,t,r)};e.onerror=function(n){i(!1,n,r)};o()},InsertALL:function(n,t,i){for(var r=0;r<t.length;r++)dbControl.Insert(n,t[r],i)},SelectALL:function(n,t){var i=dbControl.db.transaction(n,dbControl.TransactionMode.READ_ONLY),f=i.objectStore(n),r=[],u=f.openCursor();u.onerror=function(){t(null)};u.onsuccess=function(n){var t=n.target.result;t&&(r.push(t.value),t.continue())};i.oncomplete=function(){t(r)}},SelectByIndex:function(n,t,i){var u=dbControl.db.transaction([n],dbControl.TransactionMode.READ_ONLY).objectStore(n),r=u.get(t);r.onerror=function(){i(!1)};r.onsuccess=function(){var n=r.result;i(n)}},SelectByIndexComplex:function(n,t,i){var u=dbControl.db.transaction([n],dbControl.TransactionMode.READ_ONLY),o=u.objectStore(n),r=dbControl.GetKeyValues(n,t);if(r.length==0||dbControl[n].keyPath.length!=r.length){i(null);return}var s=IDBKeyRange.only(r),f=o.openCursor(s),e=[];u.oncomplete=function(){i(e)};f.onerror=function(){i(null)};f.onsuccess=function(n){var t=n.target.result;t&&(e.push(t.value),t.continue())}},SelectByHintIndexComplex:function(n,t,i,r){var o=dbControl.db.transaction([n],dbControl.TransactionMode.READ_WRITE),h=o.objectStore(n),s=h.index(t),u=dbControl.GetKeyValuesIndex(n,t,i),f,e;if(u.length==0||s.keyPath.length!=u.length){r(null);return}f=s.openCursor(u);e=[];o.oncomplete=function(){r(e)};f.onerror=function(){r(null)};f.onsuccess=function(n){var t=n.target.result;t&&(e.push(t.value),t.continue())}},UpdateByIndex:function(n,t,i,r){var f=dbControl.db.transaction([n],dbControl.TransactionMode.READ_WRITE).objectStore(n),u=f.get(t);u.onerror=function(){r(!1)};u.onsuccess=function(){var e=u.result,t;e=i;t=f.put(e);t.onerror=function(){r(!1)};t.onsuccess=function(){dbControl.UpdateSyncRegister(dbControl.TableSyncControl.Name,n,dbControl[n].Dominio);r(!0)}}},UpdateByIndexComplex:function(n,t,i,r){var e=dbControl.db.transaction([n],dbControl.TransactionMode.READ_WRITE).objectStore(n),u=dbControl.GetKeyValues(n,t),o,f;if(u.length==0||dbControl[n].keyPath.length!=u.length){i(null);return}o=IDBKeyRange.only(u);f=e.openCursor(o);f.onerror=function(){i(!1,r)};f.onsuccess=function(u){var o=u.target.result,f;o=t;f=e.put(o);f.onerror=function(){i(!1,r)};f.onsuccess=function(){dbControl.UpdateSyncRegister(dbControl.TableSyncControl.Name,n,dbControl[n].Dominio);i(!0,r)}}},DeleteByIndex:function(n,t,i,r){var u=dbControl.db.transaction([n],dbControl.TransactionMode.READ_WRITE).objectStore(n).delete(t);u.onsuccess=function(){i(!0,r)};u.onerror=function(){i(!1,r)}},DeleteByIndexComplex:function(n,t,i,r){var f=dbControl.GetKeyValues(n,t),u;f.length!=0&&(u=dbControl.db.transaction([n],dbControl.TransactionMode.READ_WRITE).objectStore(n).delete(f),u.onsuccess=function(){i(!0,r)},u.onerror=function(){i(!1,r)})},DeleteAllRows:function(n,t){var i=dbControl.db.transaction([n],dbControl.TransactionMode.READ_WRITE).objectStore(n).clear();i.onsuccess=function(){t(!0)};i.onerror=function(){t(!1)}},DeleteByHintIndexComplex:function(n,t,i,r){var e=dbControl.db.transaction([n],dbControl.TransactionMode.READ_WRITE),o=e.objectStore(n),s=o.index(t),u=dbControl.GetKeyValuesIndex(n,t,i),f;if(u.length==0||s.keyPath.length!=u.length){r(!1);return}f=s.openKeyCursor(u);e.oncomplete=function(){r(!0)};f.onerror=function(){r(!1)};f.onsuccess=function(n){var t=n.target.result;t&&(o.delete(t.primaryKey),t.continue())}}};jQuery(document).ready(function(){dbControl.Open()});
/*
//# sourceMappingURL=DbControl.min.js.map
*/